/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,s=new Promise((function(s,o){n(i=t[e].apply(t,r)).then(s,o)}));return s.request=i,s}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function s(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function o(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function a(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function c(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function u(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function d(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function f(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new d(n)}function p(t){this._db=t}s(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(h,"_cursor",["direction","key","primaryKey","value"]),o(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},s(l,"_store",["name","keyPath","indexNames","autoIncrement"]),o(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(l,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,u].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,s=i[t].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})}))})),[u,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),s=i.request;return s&&(s.onupgradeneeded=function(t){n&&n(new f(s.result,t.oldVersion,s.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function s(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create,Object.create;var o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=s>>2,l=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),r.push(n[h],n[l],n[d],n[f])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var s=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,c=++i<t.length?n[t.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(r.push(u),64!==a){var h=o<<4&240|a>>2;if(r.push(h),64!==c){var l=a<<6&192|c;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},a=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function c(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function u(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(c())}function h(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function l(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function d(){var t=c();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function f(){return"indexedDB"in self&&null!=indexedDB}function p(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}var g=function(e){function n(t,r,i){var s=e.call(this,r)||this;return s.code=t,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,m.prototype.create),s}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,e),n}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?y(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new g(i,a,r);return c},t}();function y(t,e){return t.replace(v,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var v=/\{\$([^}]+)}/g;function w(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),i=0,s=n;i<s.length;i++){var o=s[i];if(!r.includes(o))return!1;var a=t[o],c=e[o];if(I(a)&&I(c)){if(!w(a,c))return!1}else if(a!==c)return!1}for(var u=0,h=r;u<h.length;u++)if(o=h[u],!n.includes(o))return!1;return!0}function I(t){return null!==t&&"object"==typeof t}function b(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var s=i[r];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}function T(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function _(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(s=h^c&(u^h),o=1518500249):(s=c^u^h,o=1859775393):r<60?(s=c&u|h&(c|u),o=2400959708):(s=c^u^h,o=3395469782),i=(a<<5|a>>>27)+s+l+o+n[r]&4294967295,l=h,h=u,u=4294967295&(c<<30|c>>>2),c=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<e;){if(0===s)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[s]=t.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<e;)if(i[s]=t[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();var E=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=S),void 0===r.error&&(r.error=S),void 0===r.complete&&(r.complete=S);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function S(){}function k(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function A(t){return t&&t._delegate?t._delegate:t}var C,N=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),D="[DEFAULT]",R=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new a;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:D})}catch(t){}try{for(var s=r(this.instancesDeferred.entries()),o=s.next();!o.done;o=s.next()){var a=i(o.value,2),c=a[0],u=a[1],h=this.normalizeInstanceIdentifier(c);try{var l=this.getOrInitializeService({instanceIdentifier:h});u.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=D),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){var t;return function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],i(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),i(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=D),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=D),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var s=t.options,o=void 0===s?{}:s,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var c=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=r(this.instancesDeferred.entries()),h=u.next();!h.done;h=u.next()){var l=i(h.value,2),d=l[0],f=l[1];a===this.normalizeInstanceIdentifier(d)&&f.resolve(c)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return c},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&t(s,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i,s=this.onInitCallbacks.get(e);if(s)try{for(var o=r(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===D?void 0:e),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(t){}return s||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=D),this.component?this.component.multipleInstances?t:D:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),O=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new R(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function P(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var L,M=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(L||(L={}));var x={debug:L.DEBUG,verbose:L.VERBOSE,info:L.INFO,warn:L.WARN,error:L.ERROR,silent:L.SILENT},U=L.INFO,F=((C={})[L.DEBUG]="log",C[L.VERBOSE]="log",C[L.INFO]="info",C[L.WARN]="warn",C[L.ERROR]="error",C),V=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=F[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,P(["["+i+"]  "+t.name+":"],n))}},j=function(){function t(t){this.name=t,this._logLevel=U,this._logHandler=V,this._userLogHandler=null,M.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in L))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?x[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,P([this,L.DEBUG],t)),this._logHandler.apply(this,P([this,L.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,P([this,L.VERBOSE],t)),this._logHandler.apply(this,P([this,L.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,P([this,L.INFO],t)),this._logHandler.apply(this,P([this,L.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,P([this,L.WARN],t)),this._logHandler.apply(this,P([this,L.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,P([this,L.ERROR],t)),this._logHandler.apply(this,P([this,L.ERROR],t))},t}();class B{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const q="@firebase/app",z=new j("@firebase/app"),K={[q]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},H=new Map,$=new Map;function G(t,e){try{t.container.addComponent(e)}catch(n){z.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function W(t){const e=t.name;if($.has(e))return z.debug(`There were multiple attempts to register component ${e}.`),!1;$.set(e,t);for(const e of H.values())G(e,t);return!0}function J(t,e){return t.container.getProvider(e)}const X=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class Q{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new N("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw X.create("app-deleted",{appName:this._name})}}const Y="9.0.0";function Z(t="[DEFAULT]"){const e=H.get(t);if(!e)throw X.create("no-app",{appName:t});return e}function tt(t,e,n){var r;let i=null!==(r=K[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void z.warn(t.join(" "))}W(new N(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}W(new N("platform-logger",(t=>new B(t)),"PRIVATE")),tt(q,"0.7.0",undefined),tt("fire-js",""),tt("firebase","9.0.2","app");const et=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},nt=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),rt=new j("@firebase/auth");function it(t,...e){rt.logLevel<=L.ERROR&&rt.error(`Auth (9.0.0): ${t}`,...e)}function st(t,...e){throw ct(t,...e)}function ot(t,...e){return ct(t,...e)}function at(t,e,n){const r=Object.assign(Object.assign({},et()),{[e]:n});return new m("auth","Firebase",r).create(e,{appName:t.name})}function ct(t,...e){if("string"!=typeof t){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nt.create(t,...e)}function ut(t,e,...n){if(!t)throw ct(e,...n)}function ht(t){const e="INTERNAL ASSERTION FAILED: "+t;throw it(e),new Error(e)}function lt(t,e){t||ht(e)}const dt=new Map;function ft(t){lt(t instanceof Function,"Expected a class definition");let e=dt.get(t);return e?(lt(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dt.set(t,e),e)}function pt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function gt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class mt{constructor(t,e){this.shortDelay=t,this.longDelay=e,lt(e>t,"Short delay should be less than long delay!"),this.isMobile=u()||l()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===gt()||"https:"===gt()||h()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function yt(t,e){lt(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class vt{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void ht("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void ht("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void ht("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},It=new mt(3e4,6e4);function bt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Tt(t,e,n,r,i={}){return _t(t,i,(()=>{let i={},s={};r&&("GET"===e?s=r:i={body:JSON.stringify(r)});const o=b(Object.assign({key:t.config.apiKey},s)).slice(1),a=new(vt.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&a.set("X-Firebase-Locale",t.languageCode),vt.fetch()(St(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},i))}))}async function _t(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},wt),e);try{const e=new kt(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw At(t,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const e=i.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw At(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw At(t,"email-already-in-use",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw at(t,a,o);st(t,a)}}catch(e){if(e instanceof g)throw e;st(t,"network-request-failed")}}async function Et(t,e,n,r,i={}){const s=await Tt(t,e,n,r,i);return"mfaPendingCredential"in s&&st(t,"multi-factor-auth-required",{serverResponse:s}),s}function St(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?yt(t.config,i):`${t.config.apiScheme}://${i}`}class kt{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(ot(this.auth,"timeout"))),It.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function At(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ot(t,e,r);return i.customData._tokenResponse=n,i}function Ct(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function Nt(t){return 1e3*Number(t)}function Dt(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return it("JWT malformed, contained fewer than 3 sections"),null;try{const t=function(t){try{return o.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(n);return t?JSON.parse(t):(it("Failed to decode base64 JWT payload"),null)}catch(t){return it("Caught error parsing JWT payload as JSON",t),null}}async function Rt(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Ot{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class Pt{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ct(this.lastLoginAt),this.creationTime=Ct(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Lt(t){var n;const r=t.auth,i=await t.getIdToken(),s=await Rt(t,async function(t,e){return Tt(t,"POST","/v1/accounts:lookup",e)}(r,{idToken:i}));ut(null==s?void 0:s.users.length,r,"internal-error");const o=s.users[0];t._notifyReloadListener(o);const a=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?o.providerUserInfo.map((t=>{var{providerId:n}=t,r=e(t,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})):[],c=(u=t.providerData,h=a,[...u.filter((t=>!h.some((e=>e.providerId===t.providerId)))),...h]);var u,h;const l=t.isAnonymous,d=!(t.email&&o.passwordHash||(null==c?void 0:c.length)),f=!!l&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Pt(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(t,p)}class Mt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ut(t.idToken,"internal-error"),ut(void 0!==t.idToken,"internal-error"),ut(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Dt(t);return ut(e,"internal-error"),ut(void 0!==e.exp,"internal-error"),ut(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return ut(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(t,e){const n=await _t(t,{},(()=>{const n=b({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,s=St(t,r,"/v1/token",`key=${i}`);return vt.fetch()(s,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:r,expirationTime:i}=e,s=new Mt;return n&&(ut("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),r&&(ut("string"==typeof r,"internal-error",{appName:t}),s.accessToken=r),i&&(ut("number"==typeof i,"internal-error",{appName:t}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Mt,this.toJSON())}_performRefresh(){return ht("not implemented")}}function xt(t,e){ut("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Ut{constructor(t){var{uid:n,auth:r,stsTokenManager:i}=t,s=e(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Ot(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.metadata=new Pt(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Rt(this,this.stsTokenManager.getToken(this.auth,t));return ut(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=A(t),r=await n.getIdToken(e),i=Dt(r);ut(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ct(Nt(i.auth_time)),issuedAtTime:Ct(Nt(i.iat)),expirationTime:Ct(Nt(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=A(t);await Lt(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(ut(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new Ut(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Lt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Rt(this,async function(t,e){return Tt(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,r,i,s,o,a,c,u;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,l=null!==(r=e.email)&&void 0!==r?r:void 0,d=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:T}=e;ut(v&&T,t,"internal-error");const _=Mt.fromJSON(this.name,T);ut("string"==typeof v,t,"internal-error"),xt(h,t.name),xt(l,t.name),ut("boolean"==typeof w,t,"internal-error"),ut("boolean"==typeof I,t,"internal-error"),xt(d,t.name),xt(f,t.name),xt(p,t.name),xt(g,t.name),xt(m,t.name),xt(y,t.name);const E=new Ut({uid:v,auth:t,email:l,emailVerified:w,displayName:h,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((t=>Object.assign({},t)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(t,e,n=!1){const r=new Mt;r.updateFromServerResponse(e);const i=new Ut({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:n});return await Lt(i),i}}class Ft{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Ft.type="NONE";const Vt=Ft;function jt(t,e,n){return`firebase:${t}:${e}:${n}`}class Bt{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=jt(this.userKey,r.apiKey,i),this.fullPersistenceKey=jt("persistence",r.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Ut._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Bt(ft(Vt),t,n);const r=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let i=r[0]||ft(Vt);const s=jt(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const r=Ut._fromJSON(t,e);n!==i&&(o=r),i=n;break}}catch(t){}const a=r.filter((t=>t._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==i)try{await t._remove(s)}catch(t){}}))),new Bt(i,t,n)):new Bt(i,t,n)}}function qt(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($t(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zt(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Wt(e))return"Blackberry";if(Jt(e))return"Webos";if(Kt(e))return"Safari";if((e.includes("chrome/")||Ht(e))&&!e.includes("edge/"))return"Chrome";if(Gt(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function zt(t=c()){return/firefox\//i.test(t)}function Kt(t=c()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ht(t=c()){return/crios\//i.test(t)}function $t(t=c()){return/iemobile/i.test(t)}function Gt(t=c()){return/android/i.test(t)}function Wt(t=c()){return/blackberry/i.test(t)}function Jt(t=c()){return/webos/i.test(t)}function Xt(t=c()){return/iphone|ipad|ipod/i.test(t)}function Qt(t=c()){return Xt(t)||Gt(t)||Jt(t)||Wt(t)||/windows phone/i.test(t)||$t(t)}function Yt(t,e=[]){let n;switch(t){case"Browser":n=qt(c());break;case"Worker":n=`${qt(c())}-${t}`;break;default:n=t}return`${n}/JsCore/9.0.0/${e.length?e.join(","):"FirebaseCore-web"}`}class Zt{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ee(this),this.idTokenSubscription=new ee(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nt,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ft(e)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await Bt.create(this,t),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(e),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(t);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Lt(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?A(t):null;return e&&ut(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&ut(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(ft(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new m("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ft(t)||this._popupRedirectResolver;ut(e,this,"argument-error"),this.redirectPersistenceManager=await Bt.create(this,[ft(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,r){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return ut(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof e?t.addObserver(e,n,r):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Yt(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function te(t){return A(t)}class ee{constructor(t){var e;this.auth=t,this.observer=null,this.addObserver=(e=new E((t=>this.observer=t),undefined)).subscribe.bind(e)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class ne{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return ht("not implemented")}_getIdTokenResponse(t){return ht("not implemented")}_linkToIdToken(t,e){return ht("not implemented")}_getReauthenticationResolver(t){return ht("not implemented")}}class re extends ne{constructor(t,e,n,r=null){super("password",n),this._email=t,this._password=e,this._tenantId=r}static _fromEmailAndPassword(t,e){return new re(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new re(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return Et(t,"POST","/v1/accounts:signInWithPassword",bt(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Et(t,"POST","/v1/accounts:signInWithEmailLink",bt(t,e))}(t,{email:this._email,oobCode:this._password});default:st(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return Tt(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Et(t,"POST","/v1/accounts:signInWithEmailLink",bt(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:st(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ie(t,e){return Et(t,"POST","/v1/accounts:signInWithIdp",bt(t,e))}class se extends ne{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new se(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):st("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:i}=n,s=e(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new se(r,i);return Object.assign(o,s),o}_getIdTokenResponse(t){return ie(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,ie(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ie(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=b(e)}return t}}const oe={USER_NOT_FOUND:"user-not-found"};class ae extends ne{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new ae({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new ae({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Et(t,"POST","/v1/accounts:signInWithPhoneNumber",bt(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Et(t,"POST","/v1/accounts:signInWithPhoneNumber",bt(t,e));if(n.temporaryProof)throw At(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Et(t,"POST","/v1/accounts:signInWithPhoneNumber",bt(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),oe)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:r}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:r}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}=t;return n||e||r||i?new ae({verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class ce{constructor(t){var e,n,r,i,s,o;const a=T(_(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);ut(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=T(_(t)).link,n=e?T(_(e)).deep_link_id:null,r=T(_(t)).deep_link_id;return(r?T(_(r)).link:null)||r||n||e||t}(t);try{return new ce(e)}catch(t){return null}}}class ue{constructor(){this.providerId=ue.PROVIDER_ID}static credential(t,e){return re._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ce.parseLink(e);return ut(n,"argument-error"),re._fromEmailAndCode(t,n.code,n.tenantId)}}ue.PROVIDER_ID="password",ue.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ue.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class he{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class le extends he{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class de extends le{constructor(){super("facebook.com")}static credential(t){return se._fromParams({providerId:de.PROVIDER_ID,signInMethod:de.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return de.credentialFromTaggedObject(t)}static credentialFromError(t){return de.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return de.credential(t.oauthAccessToken)}catch(t){return null}}}de.FACEBOOK_SIGN_IN_METHOD="facebook.com",de.PROVIDER_ID="facebook.com";class fe extends le{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return se._fromParams({providerId:fe.PROVIDER_ID,signInMethod:fe.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return fe.credentialFromTaggedObject(t)}static credentialFromError(t){return fe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return fe.credential(e,n)}catch(t){return null}}}fe.GOOGLE_SIGN_IN_METHOD="google.com",fe.PROVIDER_ID="google.com";class pe extends le{constructor(){super("github.com")}static credential(t){return se._fromParams({providerId:pe.PROVIDER_ID,signInMethod:pe.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return pe.credentialFromTaggedObject(t)}static credentialFromError(t){return pe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return pe.credential(t.oauthAccessToken)}catch(t){return null}}}pe.GITHUB_SIGN_IN_METHOD="github.com",pe.PROVIDER_ID="github.com";class ge extends le{constructor(){super("twitter.com")}static credential(t,e){return se._fromParams({providerId:ge.PROVIDER_ID,signInMethod:ge.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ge.credentialFromTaggedObject(t)}static credentialFromError(t){return ge.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ge.credential(e,n)}catch(t){return null}}}ge.TWITTER_SIGN_IN_METHOD="twitter.com",ge.PROVIDER_ID="twitter.com";class me{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,r=!1){const i=await Ut._fromIdTokenResponse(t,n,r),s=ye(n);return new me({user:i,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const r=ye(n);return new me({user:t,providerId:r,_tokenResponse:n,operationType:e})}}function ye(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class ve extends g{constructor(t,e,n,r){var i;super(e.code,e.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,ve.prototype),this.appName=t.name,this.code=e.code,this.tenantId=null!==(i=t.tenantId)&&void 0!==i?i:void 0,this.serverResponse=e.customData.serverResponse}static _fromErrorAndOperation(t,e,n,r){return new ve(t,e,n,r)}}function we(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw ve._fromErrorAndOperation(t,n,e,r);throw n}))}new WeakMap;const Ie="__sak";class be{constructor(t,e){this.storage=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Ie,"1"),this.storage.removeItem(Ie),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}}class Te extends be{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=c();return Kt(t)||Xt(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Qt(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),r=this.localCache[e];n!==r&&t(e,r,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(t.newValue!==r)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},i=this.storage.getItem(n);d()&&10===document.documentMode&&i!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,10):r()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Te.type="LOCAL";const _e=Te;class Ee extends be{constructor(){super(window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Ee.type="SESSION";const Se=Ee;class ke{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new ke(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:r,data:i}=e.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async t=>t(e.origin,i))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ae(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}ke.receivers=[];class Ce{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Ae("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(e.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Ne(){return window}function De(){return void 0!==Ne().WorkerGlobalScope&&"function"==typeof Ne().importScripts}const Re="firebaseLocalStorageDb",Oe="firebaseLocalStorage",Pe="fbase_key";class Le{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Me(t,e){return t.transaction([Oe],e?"readwrite":"readonly").objectStore(Oe)}function xe(){const t=indexedDB.open(Re,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Oe,{keyPath:Pe})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Oe)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Re);return new Le(t).toPromise()}(),e(await xe()))}))}))}async function Ue(t,e,n){const r=Me(t,!0).put({[Pe]:e,value:n});return new Le(r).toPromise()}function Fe(t,e){const n=Me(t,!0).delete(e);return new Le(n).toPromise()}class Ve{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await xe()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return De()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ke._getInstance(De()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Ce(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await xe();return await Ue(t,Ie,"1"),await Fe(t,Ie),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ue(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Me(t,!1).get(e),r=await new Le(n).toPromise();return void 0===r?null:r.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Fe(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Me(t,!1).getAll();return new Le(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:r,value:i}of t)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),e.push(r));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ve.type="LOCAL";const je=Ve;function Be(t){return`__${t}${Math.floor(1e6*Math.random())}`}Be("rcb"),new mt(3e4,6e4);class qe{constructor(t){this.providerId=qe.PROVIDER_ID,this.auth=te(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var r;const i=await n.verify();try{let s;if(ut("string"==typeof i,t,"argument-error"),ut("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){ut("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Tt(t,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:t.tenantId},e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{ut("signin"===e.type,t,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;ut(n,t,"missing-multi-factor-info");const o=await function(t,e){return Tt(t,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Tt(t,"POST","/v1/accounts:sendVerificationCode",bt(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return e}}finally{n._reset()}}(this.auth,t,A(e))}static credential(t,e){return ae._fromVerification(t,e)}static credentialFromResult(t){const e=t;return qe.credentialFromTaggedObject(e)}static credentialFromError(t){return qe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?ae._fromTokenResponse(e,n):null}}function ze(t,e){return e?ft(e):(ut(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}qe.PROVIDER_ID="phone",qe.PHONE_SIGN_IN_METHOD="phone";class Ke extends ne{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ie(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ie(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ie(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function He(t){return async function(t,e,n=!1){const r="signIn",i=await we(t,r,e),s=await me._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Ke(t),t.bypassAuthState)}function $e(t){const{auth:e,user:n}=t;return ut(n,e,"internal-error"),async function(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Rt(t,we(r,i,e,t),n);ut(s.idToken,r,"internal-error");const o=Dt(s.idToken);ut(o,r,"internal-error");const{sub:a}=o;return ut(t.uid===a,r,"user-mismatch"),me._forOperation(t,i,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&st(r,"user-mismatch"),t}}(n,new Ke(t),t.bypassAuthState)}async function Ge(t){const{auth:e,user:n}=t;return ut(n,e,"internal-error"),async function(t,e,n=!1){const r=await Rt(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return me._forOperation(t,"link",r)}(n,new Ke(t),t.bypassAuthState)}class We{constructor(t,e,n,r,i=!1){this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return He;case"linkViaPopup":case"linkViaRedirect":return Ge;case"reauthViaPopup":case"reauthViaRedirect":return $e;default:st(this.auth,"internal-error")}}resolve(t){lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Je=new mt(2e3,1e4);async function Xe(t,e,n){const r=te(t);!function(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&st(t,"argument-error"),at(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,e,he);const i=ze(r,n);return new Qe(r,"signInViaPopup",e,i).executeNotNull()}class Qe extends We{constructor(t,e,n,r,i){super(t,e,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Qe.currentPopupAction&&Qe.currentPopupAction.cancel(),Qe.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ut(t,this.auth,"internal-error"),t}async onExecution(){lt(1===this.filter.length,"Popup operations only handle one event");const t=Ae();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(ot(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qe.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(ot(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Je.get())};t()}}Qe.currentPopupAction=null;const Ye=new Map;class Ze extends We{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Ye.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return jt("pendingRedirect",t.config.apiKey,t.name)}(e),r="true"===await tn(t)._get(n);return await tn(t)._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Ye.set(this.auth._key(),t)}return t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function tn(t){return ft(t._redirectPersistence)}async function en(t,e,n=!1){const r=te(t),i=ze(r,e),s=new Ze(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}class nn{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sn(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!sn(t)){const r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(ot(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rn(t))}saveEventToCache(t){this.cachedEventUids.add(rn(t)),this.lastProcessedEventTime=Date.now()}}function rn(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function sn({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const on=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,an=/^https?/;function cn(t){const e=pt(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return""===i.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!an.test(n))return!1;if(on.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const un=new mt(3e4,6e4);function hn(){const t=Ne().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let ln=null;function dn(t){return ln=ln||function(t){return new Promise(((e,n)=>{var r,i,s,o;function a(){hn(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hn(),n(ot(t,"network-request-failed"))},timeout:un.get()})}if(null===(i=null===(r=Ne().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Ne().gapi)||void 0===s?void 0:s.load)){const e=Be("iframefcb");return Ne()[e]=()=>{gapi.load?a():n(ot(t,"network-request-failed"))},o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=ot("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))}a()}})).catch((t=>{throw ln=null,t}))}(t),ln}const fn=new mt(5e3,15e3),pn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},gn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mn(t){const e=t.config;ut(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?yt(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,r={apiKey:e.apiKey,appName:t.name,v:Y},i=gn.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${b(r).slice(1)}`}const yn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vn{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function wn(t,e,n,r,i,s){ut(t.config.authDomain,t,"auth-domain-config-required"),ut(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Y,eventId:i};if(e instanceof he){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof le){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?yt(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${b(a).slice(1)}`}const In="webStorageSupport",bn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Se,this._completeRedirectFn=en}async _openPopup(t,e,n,r){var i;return lt(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(t,e,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},yn),{width:r.toString(),height:i.toString(),top:s,left:o}),h=c().toLowerCase();n&&(a=Ht(h)?"_blank":n),zt(h)&&(e=e||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=c()){var e;return Xt(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",a),new vn(null);const d=window.open(e||"",a,l);ut(d,t,"popup-blocked");try{d.focus()}catch(t){}return new vn(d)}(t,wn(t,e,n,pt(),r),Ae())}async _openRedirect(t,e,n,r){var i;return await this._originValidation(t),i=wn(t,e,n,pt(),r),Ne().location.href=i,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(lt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n}async initAndGetManager(t){const e=await async function(t){const e=await dn(t),n=Ne().gapi;return ut(n,t,"internal-error"),e.open({where:document.body,url:mn(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pn,dontclear:!0},(e=>new Promise((async(n,r)=>{await e.restyle({setHideOnLeave:!1});const i=ot(t,"network-request-failed"),s=Ne().setTimeout((()=>{r(i)}),fn.get());function o(){Ne().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{r(i)}))}))))}(t),n=new nn(t);return e.register("authEvent",(e=>(ut(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(In,{type:In},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&e(!!i),st(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Tt(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(cn(t))return}catch(t){}st(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Qt()||Kt()||Xt()}};var Tn;class _n{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}Tn="Browser",W(new N("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(t=>{ut(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),ut(!(null==i?void 0:i.includes(":")),"argument-error",{appName:t.name});const n={apiKey:r,authDomain:i,clientPlatform:Tn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yt(Tn)},s=new Zt(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ft);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,null==e?void 0:e.popupRedirectResolver)}(s,e),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),W(new N("auth-internal",(t=>(t=>new _n(t))(te(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),tt("@firebase/auth","0.17.2",void 0);var En=function(t,e){return En=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},En(t,e)};function Sn(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var kn,An="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Cn=Cn||{},Nn=An||self;function Dn(){}function Rn(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function On(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Pn="closure_uid_"+(1e9*Math.random()>>>0),Ln=0;function Mn(t,e,n){return t.call.apply(t.bind,arguments)}function xn(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Un(t,e,n){return(Un=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Mn:xn).apply(null,arguments)}function Fn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Vn(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function jn(){this.s=this.s,this.o=this.o}var Bn={};jn.prototype.s=!1,jn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Pn)&&t[Pn]||(t[Pn]=++Ln)}(this);delete Bn[t]}},jn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var qn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},zn=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,s=0;s<r;s++)s in i&&e.call(n,i[s],s,t)};function Kn(t){return Array.prototype.concat.apply([],arguments)}function Hn(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function $n(t){return/^[\s\xa0]*$/.test(t)}var Gn,Wn=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Jn(t,e){return-1!=t.indexOf(e)}function Xn(t,e){return t<e?-1:t>e?1:0}t:{var Qn=Nn.navigator;if(Qn){var Yn=Qn.userAgent;if(Yn){Gn=Yn;break t}}Gn=""}function Zn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tr(t){var e={};for(var n in t)e[n]=t[n];return e}var er="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nr(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var s=0;s<er.length;s++)n=er[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rr(t){return rr[" "](t),t}rr[" "]=Dn;var ir,sr,or=Jn(Gn,"Opera"),ar=Jn(Gn,"Trident")||Jn(Gn,"MSIE"),cr=Jn(Gn,"Edge"),ur=cr||ar,hr=Jn(Gn,"Gecko")&&!(Jn(Gn.toLowerCase(),"webkit")&&!Jn(Gn,"Edge"))&&!(Jn(Gn,"Trident")||Jn(Gn,"MSIE"))&&!Jn(Gn,"Edge"),lr=Jn(Gn.toLowerCase(),"webkit")&&!Jn(Gn,"Edge");function dr(){var t=Nn.document;return t?t.documentMode:void 0}t:{var fr="",pr=(sr=Gn,hr?/rv:([^\);]+)(\)|;)/.exec(sr):cr?/Edge\/([\d\.]+)/.exec(sr):ar?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(sr):lr?/WebKit\/(\S+)/.exec(sr):or?/(?:Version)[ \/]?(\S+)/.exec(sr):void 0);if(pr&&(fr=pr?pr[1]:""),ar){var gr=dr();if(null!=gr&&gr>parseFloat(fr)){ir=String(gr);break t}}ir=fr}var mr,yr={};function vr(){return t=yr,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=Wn(String(ir)).split("."),n=Wn("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var s=e[i]||"",o=n[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;t=Xn(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||Xn(0==s[2].length,0==o[2].length)||Xn(s[2],o[2]),s=s[3],o=o[3]}while(0==t)}return 0<=t}();var t}Nn.document&&ar?mr=dr()||parseInt(ir,10)||void 0:mr=void 0;var wr=mr,Ir=function(){if(!Nn.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Nn.addEventListener("test",Dn,e),Nn.removeEventListener("test",Dn,e)}catch(t){}return t}();function br(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Tr(t,e){if(br.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(hr){t:{try{rr(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_r[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Tr.Z.h.call(this)}}br.prototype.h=function(){this.defaultPrevented=!0},Vn(Tr,br);var _r={2:"touch",3:"pen",4:"mouse"};Tr.prototype.h=function(){Tr.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Er="closure_listenable_"+(1e6*Math.random()|0),Sr=0;function kr(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Sr,this.ca=this.fa=!1}function Ar(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Cr(t){this.src=t,this.g={},this.h=0}function Nr(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=qn(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Ar(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Dr(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==r)return i}return-1}Cr.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Dr(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new kr(e,this.src,s,!!r,i)).fa=n,t.push(e)),e};var Rr="closure_lm_"+(1e6*Math.random()|0),Or={};function Pr(t,e,n,r,i){if(r&&r.once)return Mr(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Pr(t,e[s],n,r,i);return null}return n=qr(n),t&&t[Er]?t.N(e,n,On(r)?!!r.capture:!!r,i):Lr(t,e,n,!1,r,i)}function Lr(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=On(i)?!!i.capture:!!i,a=jr(t);if(a||(t[Rr]=a=new Cr(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){var t=Vr;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ir||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Fr(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mr(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Mr(t,e[s],n,r,i);return null}return n=qr(n),t&&t[Er]?t.O(e,n,On(r)?!!r.capture:!!r,i):Lr(t,e,n,!0,r,i)}function xr(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)xr(t,e[s],n,r,i);else r=On(r)?!!r.capture:!!r,n=qr(n),t&&t[Er]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Dr(s=t.g[e],n,r,i))&&(Ar(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=jr(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Dr(e,n,r,i)),(n=-1<t?e[t]:null)&&Ur(n))}function Ur(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Er])Nr(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Fr(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jr(e))?(Nr(n,t),0==n.h&&(n.src=null,e[Rr]=null)):Ar(t)}}}function Fr(t){return t in Or?Or[t]:Or[t]="on"+t}function Vr(t,e){if(t.ca)t=!0;else{e=new Tr(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Ur(t),t=n.call(r,e)}return t}function jr(t){return(t=t[Rr])instanceof Cr?t:null}var Br="__closure_events_fn_"+(1e9*Math.random()>>>0);function qr(t){return"function"==typeof t?t:(t[Br]||(t[Br]=function(e){return t.handleEvent(e)}),t[Br])}function zr(){jn.call(this),this.i=new Cr(this),this.P=this,this.I=null}function Kr(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new br(e,t);else if(e instanceof br)e.target=e.target||t;else{var i=e;nr(e=new br(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Hr(o,r,!0,e)&&i}if(i=Hr(o=e.g=t,r,!0,e)&&i,i=Hr(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Hr(o=e.g=n[s],r,!1,e)&&i}function Hr(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Nr(t.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}Vn(zr,jn),zr.prototype[Er]=!0,zr.prototype.removeEventListener=function(t,e,n,r){xr(this,t,e,n,r)},zr.prototype.M=function(){if(zr.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Ar(n[r]);delete e.g[t],e.h--}}this.I=null},zr.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},zr.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var $r=Nn.JSON.stringify;function Gr(){var t=ei,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Wr,Jr=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Xr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Xr=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Qr}),(function(t){return t.reset()})),Qr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Yr(t){Nn.setTimeout((function(){throw t}),0)}function Zr(t,e){Wr||function(){var t=Nn.Promise.resolve(void 0);Wr=function(){t.then(ni)}}(),ti||(Wr(),ti=!0),ei.add(t,e)}var ti=!1,ei=new Jr;function ni(){for(var t;t=Gr();){try{t.h.call(t.g)}catch(t){Yr(t)}var e=Xr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ti=!1}function ri(t,e){zr.call(this),this.h=t||1,this.g=e||Nn,this.j=Un(this.kb,this),this.l=Date.now()}function ii(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function si(t,e,n){if("function"==typeof t)n&&(t=Un(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Un(t.handleEvent,t)}return 2147483647<Number(e)?-1:Nn.setTimeout(t,e||0)}function oi(t){t.g=si((function(){t.g=null,t.i&&(t.i=!1,oi(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Vn(ri,zr),(kn=ri.prototype).da=!1,kn.S=null,kn.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Kr(this,"tick"),this.da&&(ii(this),this.start()))}},kn.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},kn.M=function(){ri.Z.M.call(this),ii(this),delete this.g};var ai=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}En(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:oi(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Nn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(jn);function ci(t){jn.call(this),this.h=t,this.g={}}Vn(ci,jn);var ui=[];function hi(t,e,n,r){Array.isArray(n)||(n&&(ui[0]=n.toString()),n=ui);for(var i=0;i<n.length;i++){var s=Pr(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function li(t){Zn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ur(t)}),t),t.g={}}function di(){this.g=!0}function fi(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return $r(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}ci.prototype.M=function(){ci.Z.M.call(this),li(this)},ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},di.prototype.Aa=function(){this.g=!1},di.prototype.info=function(){};var pi={},gi=null;function mi(){return gi=gi||new zr}function yi(t){br.call(this,pi.Ma,t)}function vi(t){var e=mi();Kr(e,new yi(e,t))}function wi(t,e){br.call(this,pi.STAT_EVENT,t),this.stat=e}function Ii(t){var e=mi();Kr(e,new wi(e,t))}function bi(t,e){br.call(this,pi.Na,t),this.size=e}function Ti(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Nn.setTimeout((function(){t()}),e)}pi.Ma="serverreachability",Vn(yi,br),pi.STAT_EVENT="statevent",Vn(wi,br),pi.Na="timingevent",Vn(bi,br);var _i={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ei={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Si(){}function ki(t){return t.h||(t.h=t.i())}function Ai(){}Si.prototype.h=null;var Ci,Ni={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Di(){br.call(this,"d")}function Ri(){br.call(this,"c")}function Oi(){}function Pi(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ci(this),this.P=Mi,t=ur?125:void 0,this.W=new ri(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Li}function Li(){this.i=null,this.g="",this.h=!1}Vn(Di,br),Vn(Ri,br),Vn(Oi,Si),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},Ci=new Oi;var Mi=45e3,xi={},Ui={};function Fi(t,e,n){t.K=1,t.v=as(es(e)),t.s=n,t.U=!0,Vi(t,null)}function Vi(t,e){t.F=Date.now(),zi(t),t.A=es(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Is(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Li,t.g=To(t.l,n?e:null,!t.s),0<t.O&&(t.L=new ai(Un(t.Ia,t,t.g),t.O)),hi(t.V,t.g,"readystatechange",t.gb),e=t.H?tr(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),vi(1),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function ji(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Bi(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=qi(t,n))==Ui){4==e&&(t.o=4,Ii(14),i=!1),fi(t.j,t.m,null,"[Incomplete Response]");break}if(r==xi){t.o=4,Ii(15),fi(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}fi(t.j,t.m,r,null),Wi(t,r)}ji(t)&&r!=Ui&&r!=xi&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ii(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),po(e),e.L=!0,Ii(11))):(fi(t.j,t.m,n,"[Invalid Chunked Response]"),Gi(t),$i(t))}function qi(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ui:(n=Number(e.substring(n,r)),isNaN(n)?xi:(r+=1)+n>e.length?Ui:(e=e.substr(r,n),t.C=r+n,e))}function zi(t){t.Y=Date.now()+t.P,Ki(t,t.P)}function Ki(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ti(Un(t.eb,t),e)}function Hi(t){t.B&&(Nn.clearTimeout(t.B),t.B=null)}function $i(t){0==t.l.G||t.I||yo(t.l,t)}function Gi(t){Hi(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,ii(t.W),li(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Wi(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||As(n.i,t)))if(n.I=t.N,!t.J&&As(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(s){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;mo(n),io(n)}fo(n),Ii(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ti(Un(n.ab,n),6e3));if(1>=ks(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else wo(n,11)}else if((t.J||n.g==t)&&mo(n),!$n(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var s=i[e];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=t.g;if(u){var h=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Jn(h,"spdy")||Jn(h,"quic")||Jn(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Cs(l,l.h),l.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.sa=d,os(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=t;if((r=n).oa=bo(r,r.H?r.la:null,r.W),f.J){Ns(r.i,f);var p=f,g=r.K;g&&p.setTimeout(g),p.B&&(Hi(p),zi(p)),r.g=f}else lo(r);0<n.l.length&&ao(n)}else"stop"!=s[0]&&"close"!=s[0]||wo(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?wo(n,7):ro(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}vi(4)}catch(s){}}function Ji(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Rn(t)||"string"==typeof t)zn(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Rn(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Rn(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}}function Xi(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xi)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qi(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Yi(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Yi(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Yi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(kn=Pi.prototype).setTimeout=function(t){this.P=t},kn.gb=function(t){t=t.target;var e=this.L;e&&3==Ys(t)?e.l():this.Ia(t)},kn.Ia=function(t){try{if(t==this.g)t:{var e=Ys(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||ur||this.g&&(this.h.h||this.g.ga()||Zs(this.g)))){this.I||4!=e||7==n||vi(8==n||0>=r?3:2),Hi(this);var i=this.g.ba();this.N=i;e:if(ji(this)){var s=Zs(this.g);t="";var o=s.length,a=4==Ys(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Gi(this),$i(this);var c="";break e}this.h.i=new Nn.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=t,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var u,h=this.g;if((u=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$n(u)){var l=u;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Ii(12),Gi(this),$i(this);break t}fi(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Wi(this,i)}this.U?(Bi(this,e,c),ur&&this.i&&3==e&&(hi(this.V,this.W,"tick",this.fb),this.W.start())):(fi(this.j,this.m,c,null),Wi(this,c)),4==e&&Gi(this),this.i&&!this.I&&(4==e?yo(this.l,this):(this.i=!1,zi(this)))}else 400==i&&0<c.indexOf("Unknown SID")?(this.o=3,Ii(12)):(this.o=0,Ii(13)),Gi(this),$i(this)}}}catch(e){}},kn.fb=function(){if(this.g){var t=Ys(this.g),e=this.g.ga();this.C<e.length&&(Hi(this),Bi(this,t,e),this.i&&4!=t&&zi(this))}},kn.cancel=function(){this.I=!0,Gi(this)},kn.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(vi(3),Ii(17)),Gi(this),this.o=2,$i(this)):Ki(this,this.Y-t)},(kn=Xi.prototype).R=function(){Qi(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},kn.T=function(){return Qi(this),this.g.concat()},kn.get=function(t,e){return Yi(this.h,t)?this.h[t]:e},kn.set=function(t,e){Yi(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},kn.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);t.call(e,s,i,this)}};var Zi=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ts(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ts){this.g=void 0!==e?e:t.g,ns(this,t.j),this.s=t.s,rs(this,t.i),is(this,t.m),this.l=t.l,e=t.h;var n=new ms;n.i=e.i,e.g&&(n.g=new Xi(e.g),n.h=e.h),ss(this,n),this.o=t.o}else t&&(n=String(t).match(Zi))?(this.g=!!e,ns(this,n[1]||"",!0),this.s=cs(n[2]||""),rs(this,n[3]||"",!0),is(this,n[4]),this.l=cs(n[5]||"",!0),ss(this,n[6]||"",!0),this.o=cs(n[7]||"")):(this.g=!!e,this.h=new ms(null,this.g))}function es(t){return new ts(t)}function ns(t,e,n){t.j=n?cs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function rs(t,e,n){t.i=n?cs(e,!0):e}function is(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ss(t,e,n){e instanceof ms?(t.h=e,function(t,e){e&&!t.j&&(ys(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(vs(this,e),Is(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=us(e,ps)),t.h=new ms(e,t.g))}function os(t,e,n){t.h.set(e,n)}function as(t){return os(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function cs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function us(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hs),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hs(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ts.prototype.toString=function(){var t=[],e=this.j;e&&t.push(us(e,ls,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(us(e,ls,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(us(n,"/"==n.charAt(0)?fs:ds,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",us(n,gs)),t.join("")};var ls=/[#\/\?@]/g,ds=/[#\?:]/g,fs=/[#\?]/g,ps=/[#\?@]/g,gs=/#/g;function ms(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ys(t){t.g||(t.g=new Xi,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function vs(t,e){ys(t),e=bs(t,e),Yi(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Yi((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Qi(t)))}function ws(t,e){return ys(t),e=bs(t,e),Yi(t.g.h,e)}function Is(t,e,n){vs(t,e),0<n.length&&(t.i=null,t.g.set(bs(t,e),Hn(n)),t.h+=n.length)}function bs(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(kn=ms.prototype).add=function(t,e){ys(this),this.i=null,t=bs(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},kn.forEach=function(t,e){ys(this),this.g.forEach((function(n,r){zn(n,(function(n){t.call(e,n,r,this)}),this)}),this)},kn.T=function(){ys(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],s=0;s<i.length;s++)n.push(e[r]);return n},kn.R=function(t){ys(this);var e=[];if("string"==typeof t)ws(this,t)&&(e=Kn(e,this.g.get(bs(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Kn(e,t[n])}return e},kn.set=function(t,e){return ys(this),this.i=null,ws(this,t=bs(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},kn.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},kn.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),t.push(o)}}return this.i=t.join("&")};var Ts=function(t,e){this.h=t,this.g=e};function _s(t){this.l=t||Es,t=Nn.PerformanceNavigationTiming?0<(t=Nn.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Nn.g&&Nn.g.Ea&&Nn.g.Ea()&&Nn.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Es=10;function Ss(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ks(t){return t.h?1:t.g?t.g.size:0}function As(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Cs(t,e){t.g?t.g.add(e):t.h=e}function Ns(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ds(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Sn(t.g.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.D)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Hn(t.i)}function Rs(){}function Os(){this.g=new Rs}function Ps(t,e,n){var r=n||"";try{Ji(t,(function(t,n){var i=t;On(t)&&(i=$r(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Ls(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Ms(t){this.l=t.$b||null,this.j=t.ib||!1}function xs(t,e){zr.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Us,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_s.prototype.cancel=function(){var t,e;if(this.i=Ds(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Sn(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Rs.prototype.stringify=function(t){return Nn.JSON.stringify(t,void 0)},Rs.prototype.parse=function(t){return Nn.JSON.parse(t,void 0)},Vn(Ms,Si),Ms.prototype.g=function(){return new xs(this.l,this.j)},Ms.prototype.i=function(t){return function(){return t}}({}),Vn(xs,zr);var Us=0;function Fs(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Vs(t){t.readyState=4,t.l=null,t.j=null,t.A=null,js(t)}function js(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(kn=xs.prototype).open=function(t,e){if(this.readyState!=Us)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,js(this)},kn.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Nn).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},kn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Vs(this)),this.readyState=Us},kn.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,js(this)),this.g&&(this.readyState=3,js(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Nn.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Fs(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},kn.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Vs(this):js(this),3==this.readyState&&Fs(this)}},kn.Ua=function(t){this.g&&(this.response=this.responseText=t,Vs(this))},kn.Ta=function(t){this.g&&(this.response=t,Vs(this))},kn.ha=function(){this.g&&Vs(this)},kn.setRequestHeader=function(t,e){this.v.append(t,e)},kn.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},kn.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(xs.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Bs=Nn.JSON.parse;function qs(t){zr.call(this),this.headers=new Xi,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zs,this.K=this.L=!1}Vn(qs,zr);var zs="",Ks=/^https?$/i,Hs=["POST","PUT"];function $s(t){return"content-type"==t.toLowerCase()}function Gs(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ws(t),Xs(t)}function Ws(t){t.D||(t.D=!0,Kr(t,"complete"),Kr(t,"error"))}function Js(t){if(t.h&&void 0!==Cn&&(!t.C[1]||4!=Ys(t)||2!=t.ba()))if(t.v&&4==Ys(t))si(t.Fa,0,t);else if(Kr(t,"readystatechange"),4==Ys(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.H).match(Zi)[1]||null;if(!s&&Nn.self&&Nn.self.location){var o=Nn.self.location.protocol;s=o.substr(0,o.length-1)}i=!Ks.test(s?s.toLowerCase():"")}e=i}if(e)Kr(t,"complete"),Kr(t,"success");else{t.m=6;try{var a=2<Ys(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Ws(t)}}finally{Xs(t)}}}function Xs(t,e){if(t.g){Qs(t);var n=t.g,r=t.C[0]?Dn:null;t.g=null,t.C=null,e||Kr(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Qs(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Nn.clearTimeout(t.A),t.A=null)}function Ys(t){return t.g?t.g.readyState:0}function Zs(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case zs:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function to(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Zn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):os(t,e,n))}function eo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function no(t){this.za=0,this.l=[],this.h=new di,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=eo("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=eo("baseRetryDelayMs",5e3,t),this.$a=eo("retryDelaySeedMs",1e4,t),this.Ya=eo("forwardChannelMaxRetries",2,t),this.ra=eo("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new _s(t&&t.concurrentRequestLimit),this.Ca=new Os,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function ro(t){if(so(t),3==t.G){var e=t.V++,n=es(t.F);os(n,"SID",t.J),os(n,"RID",e),os(n,"TYPE","terminate"),uo(t,n),(e=new Pi(t,t.h,e,void 0)).K=2,e.v=as(es(n)),n=!1,Nn.navigator&&Nn.navigator.sendBeacon&&(n=Nn.navigator.sendBeacon(e.v.toString(),"")),!n&&Nn.Image&&((new Image).src=e.v,n=!0),n||(e.g=To(e.l,null),e.g.ea(e.v)),e.F=Date.now(),zi(e)}Io(t)}function io(t){t.g&&(po(t),t.g.cancel(),t.g=null)}function so(t){io(t),t.u&&(Nn.clearTimeout(t.u),t.u=null),mo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Nn.clearTimeout(t.m),t.m=null)}function oo(t,e){t.l.push(new Ts(t.Za++,e)),3==t.G&&ao(t)}function ao(t){Ss(t.i)||t.m||(t.m=!0,Zr(t.Ha,t),t.C=0)}function co(t,e){var n;n=e?e.m:t.V++;var r=es(t.F);os(r,"SID",t.J),os(r,"RID",n),os(r,"AID",t.U),uo(t,r),t.o&&t.s&&to(r,t.o,t.s),n=new Pi(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ho(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Cs(t.i,n),Fi(n,r,e)}function uo(t,e){t.j&&Ji({},(function(t,n){os(e,n,t)}))}function ho(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Un(t.j.Oa,t.j,t):null;t:for(var i=t.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].h,h=i[c].g;if(0>(u-=s))s=Math.max(0,i[c].h-100),a=!1;else try{Ps(h,o,"req"+u+"_")}catch(t){r&&r(h)}}if(a){r=o.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function lo(t){t.g||t.u||(t.Y=1,Zr(t.Ga,t),t.A=0)}function fo(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=Ti(Un(t.Ga,t),vo(t,t.A)),t.A++,0))}function po(t){null!=t.B&&(Nn.clearTimeout(t.B),t.B=null)}function go(t){t.g=new Pi(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=es(t.oa);os(e,"RID","rpc"),os(e,"SID",t.J),os(e,"CI",t.N?"0":"1"),os(e,"AID",t.U),uo(t,e),os(e,"TYPE","xmlhttp"),t.o&&t.s&&to(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=as(es(e)),n.s=null,n.U=!0,Vi(n,t)}function mo(t){null!=t.v&&(Nn.clearTimeout(t.v),t.v=null)}function yo(t,e){var n=null;if(t.g==e){mo(t),po(t),t.g=null;var r=2}else{if(!As(t.i,e))return;n=e.D,Ns(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Kr(r=mi(),new bi(r,n,e,i)),ao(t)}else lo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ks(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Ti(Un(t.Ha,t,e),vo(t,t.C)),t.C++,0)))}(t,e)||2==r&&fo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:wo(t,5);break;case 4:wo(t,10);break;case 3:wo(t,6);break;default:wo(t,2)}}function vo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function wo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Un(t.jb,t);n||(n=new ts("//www.google.com/images/cleardot.gif"),Nn.location&&"http"==Nn.location.protocol||ns(n,"https"),as(n)),function(t,e){var n=new di;if(Nn.Image){var r=new Image;r.onload=Fn(Ls,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Fn(Ls,n,r,"TestLoadImage: error",!1,e),r.onabort=Fn(Ls,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Fn(Ls,n,r,"TestLoadImage: timeout",!1,e),Nn.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ii(2);t.G=0,t.j&&t.j.va(e),Io(t),so(t)}function Io(t){t.G=0,t.I=-1,t.j&&(0==Ds(t.i).length&&0==t.l.length||(t.i.i.length=0,Hn(t.l),t.l.length=0),t.j.ua())}function bo(t,e,n){var r=function(t){return t instanceof ts?es(t):new ts(t,void 0)}(n);if(""!=r.i)e&&rs(r,e+"."+r.i),is(r,r.m);else{var i=Nn.location;r=function(t,e,n,r){var i=new ts(null,void 0);return t&&ns(i,t),e&&rs(i,e),n&&is(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Zn(t.aa,(function(t,e){os(r,e,t)})),e=t.D,n=t.sa,e&&n&&os(r,e,n),os(r,"VER",t.ma),uo(t,r),r}function To(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new qs(new Ms({ib:!0})):new qs(t.qa)).L=t.H,e}function _o(){}function Eo(){if(ar&&!(10<=Number(wr)))throw Error("Environmental error: no available transport.")}function So(t,e){zr.call(this),this.g=new no(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!$n(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$n(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Co(this)}function ko(t){Di.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ao(){Ri.call(this),this.status=1}function Co(t){this.g=t}(kn=qs.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ci.g(),this.C=this.u?ki(this.u):ki(Ci),this.g.onreadystatechange=Un(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Gs(this,t)}t=n||"";var i=new Xi(this.headers);r&&Ji(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=$s,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Nn.FormData&&t instanceof Nn.FormData,!(0<=qn(Hs,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Qs(this),0<this.B&&((this.K=function(t){return ar&&vr()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Un(this.pa,this)):this.A=si(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Gs(this,t)}},kn.pa=function(){void 0!==Cn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Kr(this,"timeout"),this.abort(8))},kn.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Kr(this,"complete"),Kr(this,"abort"),Xs(this))},kn.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xs(this,!0)),qs.Z.M.call(this)},kn.Fa=function(){this.s||(this.F||this.v||this.l?Js(this):this.cb())},kn.cb=function(){Js(this)},kn.ba=function(){try{return 2<Ys(this)?this.g.status:-1}catch(t){return-1}},kn.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},kn.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bs(e)}},kn.Da=function(){return this.m},kn.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(kn=no.prototype).ma=8,kn.G=1,kn.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},kn.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Pi(this,this.h,t,void 0),n=this.s;if(this.P&&(n?nr(n=tr(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var s=this.l[i];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=ho(this,e,r),os(i=es(this.F),"RID",t),os(i,"CVER",22),this.D&&os(i,"X-HTTP-Session-Id",this.D),uo(this,i),this.o&&n&&to(i,this.o,n),Cs(this.i,e),this.Ra&&os(i,"TYPE","init"),this.ja?(os(i,"$req",r),os(i,"SID","null"),e.$=!0,Fi(e,i,null)):Fi(e,i,r),this.G=2}}else 3==this.G&&(t?co(this,t):0==this.l.length||Ss(this.i)||co(this))},kn.Ga=function(){if(this.u=null,go(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ti(Un(this.bb,this),t)}},kn.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ii(10),io(this),go(this))},kn.ab=function(){null!=this.v&&(this.v=null,io(this),fo(this),Ii(19))},kn.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ii(2)):(this.h.info("Failed to ping google.com"),Ii(1))},(kn=_o.prototype).xa=function(){},kn.wa=function(){},kn.va=function(){},kn.ua=function(){},kn.Oa=function(){},Eo.prototype.g=function(t,e){return new So(t,e)},Vn(So,zr),So.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Zr(Un(t.hb,t,e))),Ii(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=bo(t,null,t.W),ao(t)},So.prototype.close=function(){ro(this.g)},So.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,oo(this.g,e)}else this.v?((e={}).__data__=$r(t),oo(this.g,e)):oo(this.g,t)},So.prototype.M=function(){this.g.j=null,delete this.j,ro(this.g),delete this.g,So.Z.M.call(this)},Vn(ko,Di),Vn(Ao,Ri),Vn(Co,_o),Co.prototype.xa=function(){Kr(this.g,"a")},Co.prototype.wa=function(t){Kr(this.g,new ko(t))},Co.prototype.va=function(t){Kr(this.g,new Ao(t))},Co.prototype.ua=function(){Kr(this.g,"b")},Eo.prototype.createWebChannel=Eo.prototype.g,So.prototype.send=So.prototype.u,So.prototype.open=So.prototype.m,So.prototype.close=So.prototype.close,_i.NO_ERROR=0,_i.TIMEOUT=8,_i.HTTP_ERROR=6,Ei.COMPLETE="complete",Ai.EventType=Ni,Ni.OPEN="a",Ni.CLOSE="b",Ni.ERROR="c",Ni.MESSAGE="d",zr.prototype.listen=zr.prototype.N,qs.prototype.listenOnce=qs.prototype.O,qs.prototype.getLastError=qs.prototype.La,qs.prototype.getLastErrorCode=qs.prototype.Da,qs.prototype.getStatus=qs.prototype.ba,qs.prototype.getResponseJson=qs.prototype.Qa,qs.prototype.getResponseText=qs.prototype.ga,qs.prototype.send=qs.prototype.ea;var No=_i,Do=Ei,Ro=pi,Oo=10,Po=11,Lo=Ms,Mo=Ai,xo=qs;class Uo{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Uo.UNAUTHENTICATED=new Uo(null),Uo.GOOGLE_CREDENTIALS=new Uo("google-credentials-uid"),Uo.FIRST_PARTY=new Uo("first-party-uid"),Uo.MOCK_USER=new Uo("mock-user");let Fo="9.0.2";const Vo=new j("@firebase/firestore");function jo(){return Vo.logLevel}function Bo(t,...e){if(Vo.logLevel<=L.DEBUG){const n=e.map(Ko);Vo.debug(`Firestore (${Fo}): ${t}`,...n)}}function qo(t,...e){if(Vo.logLevel<=L.ERROR){const n=e.map(Ko);Vo.error(`Firestore (${Fo}): ${t}`,...n)}}function zo(t,...e){if(Vo.logLevel<=L.WARN){const n=e.map(Ko);Vo.warn(`Firestore (${Fo}): ${t}`,...n)}}function Ko(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ho(t="Unexpected state"){const e=`FIRESTORE (${Fo}) INTERNAL ASSERTION FAILED: `+t;throw qo(e),new Error(e)}function $o(t,e){t||Ho()}function Go(t,e){return t}const Wo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jo extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xo{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Qo{constructor(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${t}`}}class Yo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Uo.UNAUTHENTICATED)))}shutdown(){}}class Zo{constructor(t){this.t=t,this.currentUser=Uo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Xo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xo,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{Bo("FirebaseCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Bo("FirebaseCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xo)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Bo("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?($o("string"==typeof e.accessToken),new Qo(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return $o(null===t||"string"==typeof t),new Uo(t)}}class ta{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=Uo.FIRST_PARTY}get authHeaders(){const t={"X-Goog-AuthUser":this.l},e=this.h.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.m&&(t["X-Goog-Iam-Authorization-Token"]=this.m),t}}class ea{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new ta(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(Uo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class na{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.g(t),this.p=t=>e.writeSequenceNumber(t))}g(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.p&&this.p(t),t}}function ra(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}na.T=-1;function ia(t,e){return t<e?-1:t>e?1:0}function sa(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}class oa{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Jo(Wo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Jo(Wo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Jo(Wo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Jo(Wo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return oa.fromMillis(Date.now())}static fromDate(t){return oa.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new oa(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ia(this.nanoseconds,t.nanoseconds):ia(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class aa{constructor(t){this.timestamp=t}static fromTimestamp(t){return new aa(t)}static min(){return new aa(new oa(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function ca(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ua(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class ha{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ho(),void 0===n?n=t.length-e:n>t.length-e&&Ho(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===ha.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ha?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class la extends ha{construct(t,e,n){return new la(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Jo(Wo.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new la(e)}static emptyPath(){return new la([])}}const da=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fa extends ha{construct(t,e,n){return new fa(t,e,n)}static isValidIdentifier(t){return da.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fa.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new fa(["__name__"])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Jo(Wo.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new Jo(Wo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Jo(Wo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new Jo(Wo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new fa(e)}static emptyPath(){return new fa([])}}class pa{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new pa(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new pa(e)}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ia(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pa.EMPTY_BYTE_STRING=new pa("");const ga=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ma(t){if($o(!!t),"string"==typeof t){let e=0;const n=ga.exec(t);if($o(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ya(t.seconds),nanos:ya(t.nanos)}}function ya(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function va(t){return"string"==typeof t?pa.fromBase64String(t):pa.fromUint8Array(t)}function wa(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ia(t){const e=t.mapValue.fields.__previous_value__;return wa(e)?Ia(e):e}function ba(t){const e=ma(t.mapValue.fields.__local_write_time__.timestampValue);return new oa(e.seconds,e.nanos)}function Ta(t){return null==t}function _a(t){return 0===t&&1/t==-1/0}class Ea{constructor(t){this.path=t}static fromPath(t){return new Ea(la.fromString(t))}static fromName(t){return new Ea(la.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===la.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return la.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ea(new la(t.slice()))}}function Sa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wa(t)?4:10:Ho()}function ka(t,e){const n=Sa(t);if(n!==Sa(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ba(t).isEqual(ba(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=ma(t.timestampValue),r=ma(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return va(t.bytesValue).isEqual(va(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ya(t.geoPointValue.latitude)===ya(e.geoPointValue.latitude)&&ya(t.geoPointValue.longitude)===ya(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ya(t.integerValue)===ya(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=ya(t.doubleValue),r=ya(e.doubleValue);return n===r?_a(n)===_a(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return sa(t.arrayValue.values||[],e.arrayValue.values||[],ka);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ca(n)!==ca(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!ka(n[t],r[t])))return!1;return!0}(t,e);default:return Ho()}}function Aa(t,e){return void 0!==(t.values||[]).find((t=>ka(t,e)))}function Ca(t,e){const n=Sa(t),r=Sa(e);if(n!==r)return ia(n,r);switch(n){case 0:return 0;case 1:return ia(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=ya(t.integerValue||t.doubleValue),r=ya(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Na(t.timestampValue,e.timestampValue);case 4:return Na(ba(t),ba(e));case 5:return ia(t.stringValue,e.stringValue);case 6:return function(t,e){const n=va(t),r=va(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=ia(n[t],r[t]);if(0!==e)return e}return ia(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ia(ya(t.latitude),ya(e.latitude));return 0!==n?n:ia(ya(t.longitude),ya(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=Ca(n[t],r[t]);if(e)return e}return ia(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=ia(r[t],s[t]);if(0!==e)return e;const o=Ca(n[r[t]],i[s[t]]);if(0!==o)return o}return ia(r.length,s.length)}(t.mapValue,e.mapValue);default:throw Ho()}}function Na(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ia(t,e);const n=ma(t),r=ma(e),i=ia(n.seconds,r.seconds);return 0!==i?i:ia(n.nanos,r.nanos)}function Da(t){return Ra(t)}function Ra(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=ma(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?va(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ea.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=Ra(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${Ra(t.fields[i])}`;return n+"}"}(t.mapValue):Ho();var e,n}function Oa(t){return!!t&&"integerValue"in t}function Pa(t){return!!t&&"arrayValue"in t}function La(t){return!!t&&"nullValue"in t}function Ma(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xa(t){return!!t&&"mapValue"in t}function Ua(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ua(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ua(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ua(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Fa{constructor(t){this.value=t}static empty(){return new Fa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!xa(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ua(e)}setAll(t){let e=fa.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=Ua(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());xa(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ka(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];xa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){ua(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Fa(Ua(this.value))}}class Va{constructor(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(t){return new Va(t,0,aa.min(),Fa.empty(),0)}static newFoundDocument(t,e,n){return new Va(t,1,e,n,0)}static newNoDocument(t,e){return new Va(t,2,e,Fa.empty(),0)}static newUnknownDocument(t,e){return new Va(t,3,e,Fa.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Fa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Fa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Va&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}clone(){return new Va(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ja{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.A=null}}function Ba(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ja(t,e,n,r,i,s,o)}function qa(t){const e=Go(t);if(null===e.A){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>function(t){return t.field.canonicalString()+t.op.toString()+Da(t.value)}(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Ta(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ec(e.startAt)),e.endAt&&(t+="|ub:",t+=ec(e.endAt)),e.A=t}return e.A}function za(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!rc(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!ka(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sc(t.startAt,e.startAt)&&sc(t.endAt,e.endAt)}function Ka(t){return Ea.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Ha extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.R(t,e,n):new $a(t,e,n):"array-contains"===e?new Xa(t,n):"in"===e?new Qa(t,n):"not-in"===e?new Ya(t,n):"array-contains-any"===e?new Za(t,n):new Ha(t,e,n)}static R(t,e,n){return"in"===e?new Ga(t,n):new Wa(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.P(Ca(e,this.value)):null!==e&&Sa(this.value)===Sa(e)&&this.P(Ca(e,this.value))}P(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ho()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class $a extends Ha{constructor(t,e,n){super(t,e,n),this.key=Ea.fromName(n.referenceValue)}matches(t){const e=Ea.comparator(t.key,this.key);return this.P(e)}}class Ga extends Ha{constructor(t,e){super(t,"in",e),this.keys=Ja(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Wa extends Ha{constructor(t,e){super(t,"not-in",e),this.keys=Ja(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ja(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ea.fromName(t.referenceValue)))}class Xa extends Ha{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Pa(e)&&Aa(e.arrayValue,this.value)}}class Qa extends Ha{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Aa(this.value.arrayValue,e)}}class Ya extends Ha{constructor(t,e){super(t,"not-in",e)}matches(t){if(Aa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Aa(this.value.arrayValue,e)}}class Za extends Ha{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Pa(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Aa(this.value.arrayValue,t)))}}class tc{constructor(t,e){this.position=t,this.before=e}}function ec(t){return`${t.before?"b":"a"}:${t.position.map((t=>Da(t))).join(",")}`}class nc{constructor(t,e="asc"){this.field=t,this.dir=e}}function rc(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ic(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?Ea.comparator(Ea.fromName(o.referenceValue),n.key):Ca(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sc(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ka(t.position[n],e.position[n]))return!1;return!0}class oc{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function ac(t){return new oc(t)}function cc(t){return!Ta(t.limit)&&"F"===t.limitType}function uc(t){return!Ta(t.limit)&&"L"===t.limitType}function hc(t){const e=Go(t);if(null===e.V){e.V=[];const t=function(t){for(const e of t.filters)if(e.v())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.V.push(new nc(t)),e.V.push(new nc(fa.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.V.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new nc(fa.keyField(),t))}}}return e.V}function lc(t){const e=Go(t);if(!e.S)if("F"===e.limitType)e.S=Ba(e.path,e.collectionGroup,hc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of hc(e)){const e="desc"===n.dir?"asc":"desc";t.push(new nc(n.field,e))}const n=e.endAt?new tc(e.endAt.position,!e.endAt.before):null,r=e.startAt?new tc(e.startAt.position,!e.startAt.before):null;e.S=Ba(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.S}function dc(t,e){return za(lc(t),lc(e))&&t.limitType===e.limitType}function fc(t){return`${qa(lc(t))}|lt:${t.limitType}`}function pc(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Da(e.value)}`;var e})).join(", ")}]`),Ta(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: "+ec(t.startAt)),t.endAt&&(e+=", endAt: "+ec(t.endAt)),`Target(${e})`}(lc(t))}; limitType=${t.limitType})`}function gc(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ea.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ic(t.startAt,hc(t),e)||t.endAt&&ic(t.endAt,hc(t),e))}(t,e)}function mc(t){return(e,n)=>{let r=!1;for(const i of hc(t)){const t=yc(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}function yc(t,e,n){const r=t.field.isKeyField()?Ea.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ca(r,i):Ho()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ho()}}class vc{constructor(){this._=void 0}}function wc(t,e,n){return t instanceof bc?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Tc?_c(t,e):t instanceof Ec?Sc(t,e):function(t,e){const n=function(t,e){return t instanceof kc?Oa(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}(t,e),r=Ac(n)+Ac(t.C);return Oa(n)&&Oa(t.C)?function(t){return{integerValue:""+t}}(r):function(t,e){if(t.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_a(e)?"-0":e}}(t.N,r)}(t,e)}function Ic(t,e,n){return t instanceof Tc?_c(t,e):t instanceof Ec?Sc(t,e):n}class bc extends vc{}class Tc extends vc{constructor(t){super(),this.elements=t}}function _c(t,e){const n=Cc(e);for(const e of t.elements)n.some((t=>ka(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ec extends vc{constructor(t){super(),this.elements=t}}function Sc(t,e){let n=Cc(e);for(const e of t.elements)n=n.filter((t=>!ka(t,e)));return{arrayValue:{values:n}}}class kc extends vc{constructor(t,e){super(),this.N=t,this.C=e}}function Ac(t){return ya(t.integerValue||t.doubleValue)}function Cc(t){return Pa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Nc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Dc{}function Rc(t,e,n){t instanceof Mc?function(t,e,n){const r=t.value.clone(),i=Fc(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof xc?function(t,e,n){if(!Nc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=Fc(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Uc(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Oc(t,e,n){t instanceof Mc?function(t,e,n){if(!Nc(t.precondition,e))return;const r=t.value.clone(),i=Vc(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Lc(e),r).setHasLocalMutations()}(t,e,n):t instanceof xc?function(t,e,n){if(!Nc(t.precondition,e))return;const r=Vc(t.fieldTransforms,n,e),i=e.data;i.setAll(Uc(t)),i.setAll(r),e.convertToFoundDocument(Lc(e),i).setHasLocalMutations()}(t,e,n):function(t,e){Nc(t.precondition,e)&&e.convertToNoDocument(aa.min())}(t,e)}function Pc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&sa(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Tc&&e instanceof Tc||t instanceof Ec&&e instanceof Ec?sa(t.elements,e.elements,ka):t instanceof kc&&e instanceof kc?ka(t.C,e.C):t instanceof bc&&e instanceof bc}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Lc(t){return t.isFoundDocument()?t.version:aa.min()}class Mc extends Dc{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}}class xc extends Dc{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function Uc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function Fc(t,e,n){const r=new Map;$o(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Ic(o,a,n[i]))}return r}function Vc(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,wc(t,s,e))}return r}class jc{constructor(t){this.count=t}}var Bc,qc;function zc(t){if(void 0===t)return qo("GRPC error has no .code"),Wo.UNKNOWN;switch(t){case Bc.OK:return Wo.OK;case Bc.CANCELLED:return Wo.CANCELLED;case Bc.UNKNOWN:return Wo.UNKNOWN;case Bc.DEADLINE_EXCEEDED:return Wo.DEADLINE_EXCEEDED;case Bc.RESOURCE_EXHAUSTED:return Wo.RESOURCE_EXHAUSTED;case Bc.INTERNAL:return Wo.INTERNAL;case Bc.UNAVAILABLE:return Wo.UNAVAILABLE;case Bc.UNAUTHENTICATED:return Wo.UNAUTHENTICATED;case Bc.INVALID_ARGUMENT:return Wo.INVALID_ARGUMENT;case Bc.NOT_FOUND:return Wo.NOT_FOUND;case Bc.ALREADY_EXISTS:return Wo.ALREADY_EXISTS;case Bc.PERMISSION_DENIED:return Wo.PERMISSION_DENIED;case Bc.FAILED_PRECONDITION:return Wo.FAILED_PRECONDITION;case Bc.ABORTED:return Wo.ABORTED;case Bc.OUT_OF_RANGE:return Wo.OUT_OF_RANGE;case Bc.UNIMPLEMENTED:return Wo.UNIMPLEMENTED;case Bc.DATA_LOSS:return Wo.DATA_LOSS;default:return Ho()}}(qc=Bc||(Bc={}))[qc.OK=0]="OK",qc[qc.CANCELLED=1]="CANCELLED",qc[qc.UNKNOWN=2]="UNKNOWN",qc[qc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qc[qc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qc[qc.NOT_FOUND=5]="NOT_FOUND",qc[qc.ALREADY_EXISTS=6]="ALREADY_EXISTS",qc[qc.PERMISSION_DENIED=7]="PERMISSION_DENIED",qc[qc.UNAUTHENTICATED=16]="UNAUTHENTICATED",qc[qc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qc[qc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qc[qc.ABORTED=10]="ABORTED",qc[qc.OUT_OF_RANGE=11]="OUT_OF_RANGE",qc[qc.UNIMPLEMENTED=12]="UNIMPLEMENTED",qc[qc.INTERNAL=13]="INTERNAL",qc[qc.UNAVAILABLE=14]="UNAVAILABLE",qc[qc.DATA_LOSS=15]="DATA_LOSS";class Kc{constructor(t,e){this.comparator=t,this.root=e||$c.EMPTY}insert(t,e){return new Kc(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,$c.BLACK,null,null))}remove(t){return new Kc(this.comparator,this.root.remove(t,this.comparator).copy(null,null,$c.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Hc(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Hc(this.root,t,this.comparator,!1)}getReverseIterator(){return new Hc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Hc(this.root,t,this.comparator,!0)}}class Hc{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class $c{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$c.RED,this.left=null!=r?r:$c.EMPTY,this.right=null!=i?i:$c.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new $c(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return $c.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return $c.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,$c.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,$c.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ho();if(this.right.isRed())throw Ho();const t=this.left.check();if(t!==this.right.check())throw Ho();return t+(this.isRed()?0:1)}}$c.EMPTY=null,$c.RED=!0,$c.BLACK=!1,$c.EMPTY=new class{constructor(){this.size=0}get key(){throw Ho()}get value(){throw Ho()}get color(){throw Ho()}get left(){throw Ho()}get right(){throw Ho()}copy(t,e,n,r,i){return this}insert(t,e,n){return new $c(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gc{constructor(t){this.comparator=t,this.data=new Kc(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Wc(this.data.getIterator())}getIteratorFrom(t){return new Wc(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Gc))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Gc(this.comparator);return e.data=t,e}}class Wc{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Jc=new Kc(Ea.comparator);function Xc(){return Jc}const Qc=new Kc(Ea.comparator);function Yc(){return Qc}new Kc(Ea.comparator);const Zc=new Gc(Ea.comparator);function tu(...t){let e=Zc;for(const n of t)e=e.add(n);return e}const eu=new Gc(ia);function nu(){return eu}class ru{constructor(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e){const n=new Map;return n.set(t,iu.createSynthesizedTargetChangeForCurrentChange(t,e)),new ru(aa.min(),n,nu(),Xc(),tu())}}class iu{constructor(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e){return new iu(pa.EMPTY_BYTE_STRING,e,tu(),tu(),tu())}}class su{constructor(t,e,n,r){this.k=t,this.removedTargetIds=e,this.key=n,this.$=r}}class ou{constructor(t,e){this.targetId=t,this.O=e}}class au{constructor(t,e,n=pa.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class cu{constructor(){this.F=0,this.M=lu(),this.L=pa.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(t){t.approximateByteSize()>0&&(this.U=!0,this.L=t)}W(){let t=tu(),e=tu(),n=tu();return this.M.forEach(((r,i)=>{switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ho()}})),new iu(this.L,this.B,t,e,n)}G(){this.U=!1,this.M=lu()}H(t,e){this.U=!0,this.M=this.M.insert(t,e)}J(t){this.U=!0,this.M=this.M.remove(t)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class uu{constructor(t){this.tt=t,this.et=new Map,this.nt=Xc(),this.st=hu(),this.it=new Gc(ia)}rt(t){for(const e of t.k)t.$&&t.$.isFoundDocument()?this.ot(e,t.$):this.at(e,t.key,t.$);for(const e of t.removedTargetIds)this.at(e,t.key,t.$)}ct(t){this.forEachTarget(t,(e=>{const n=this.ut(e);switch(t.state){case 0:this.ht(e)&&n.j(t.resumeToken);break;case 1:n.X(),n.q||n.G(),n.j(t.resumeToken);break;case 2:n.X(),n.q||this.removeTarget(e);break;case 3:this.ht(e)&&(n.Z(),n.j(t.resumeToken));break;case 4:this.ht(e)&&(this.lt(e),n.j(t.resumeToken));break;default:Ho()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.et.forEach(((t,n)=>{this.ht(n)&&e(n)}))}ft(t){const e=t.targetId,n=t.O.count,r=this.dt(e);if(r){const t=r.target;if(Ka(t))if(0===n){const n=new Ea(t.path);this.at(e,n,Va.newNoDocument(n,aa.min()))}else $o(1===n);else this.wt(e)!==n&&(this.lt(e),this.it=this.it.add(e))}}_t(t){const e=new Map;this.et.forEach(((n,r)=>{const i=this.dt(r);if(i){if(n.current&&Ka(i.target)){const e=new Ea(i.target.path);null!==this.nt.get(e)||this.gt(r,e)||this.at(r,e,Va.newNoDocument(e,t))}n.K&&(e.set(r,n.W()),n.G())}}));let n=tu();this.st.forEach(((t,e)=>{let r=!0;e.forEachWhile((t=>{const e=this.dt(t);return!e||2===e.purpose||(r=!1,!1)})),r&&(n=n.add(t))}));const r=new ru(t,e,this.it,this.nt,n);return this.nt=Xc(),this.st=hu(),this.it=new Gc(ia),r}ot(t,e){if(!this.ht(t))return;const n=this.gt(t,e.key)?2:0;this.ut(t).H(e.key,n),this.nt=this.nt.insert(e.key,e),this.st=this.st.insert(e.key,this.yt(e.key).add(t))}at(t,e,n){if(!this.ht(t))return;const r=this.ut(t);this.gt(t,e)?r.H(e,1):r.J(e),this.st=this.st.insert(e,this.yt(e).delete(t)),n&&(this.nt=this.nt.insert(e,n))}removeTarget(t){this.et.delete(t)}wt(t){const e=this.ut(t).W();return this.tt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Y(t){this.ut(t).Y()}ut(t){let e=this.et.get(t);return e||(e=new cu,this.et.set(t,e)),e}yt(t){let e=this.st.get(t);return e||(e=new Gc(ia),this.st=this.st.insert(t,e)),e}ht(t){const e=null!==this.dt(t);return e||Bo("WatchChangeAggregator","Detected inactive target",t),e}dt(t){const e=this.et.get(t);return e&&e.q?null:this.tt.Et(t)}lt(t){this.et.set(t,new cu),this.tt.getRemoteKeysForTarget(t).forEach((e=>{this.at(t,e,null)}))}gt(t,e){return this.tt.getRemoteKeysForTarget(t).has(e)}}function hu(){return new Kc(Ea.comparator)}function lu(){return new Kc(Ea.comparator)}const du={asc:"ASCENDING",desc:"DESCENDING"},fu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class pu{constructor(t,e){this.databaseId=t,this.D=e}}function gu(t){return $o(!!t),aa.fromTimestamp(function(t){const e=ma(t);return new oa(e.seconds,e.nanos)}(t))}function mu(t){const e=la.fromString(t);return $o(Pu(e)),e}function yu(t,e){const n=mu(e);if(n.get(1)!==t.databaseId.projectId)throw new Jo(Wo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Jo(Wo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ea(Iu(n))}function vu(t,e){return function(t,e){return function(t){return new la(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}(t.databaseId,e)}function wu(t){return new la(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Iu(t){return $o(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function bu(t,e){return{documents:[vu(t,e.path)]}}function Tu(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=vu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=vu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Ma(t.value))return{unaryFilter:{field:Nu(t.field),op:"IS_NAN"}};if(La(t.value))return{unaryFilter:{field:Nu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ma(t.value))return{unaryFilter:{field:Nu(t.field),op:"IS_NOT_NAN"}};if(La(t.value))return{unaryFilter:{field:Nu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nu(t.field),op:Cu(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Nu(t.field),direction:Au(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.D||Ta(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=Su(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Su(e.endAt)),n}function _u(t){let e=function(t){const e=mu(t);return 4===e.length?la.emptyPath():Iu(e)}(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){$o(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=Eu(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new nc(Du(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Ta(e)?null:e}(n.limit));let c=null;n.startAt&&(c=ku(n.startAt));let u=null;return n.endAt&&(u=ku(n.endAt)),function(t,e,n,r,i,s,o,a){return new oc(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",c,u)}function Eu(t){return t?void 0!==t.unaryFilter?[Ou(t)]:void 0!==t.fieldFilter?[Ru(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Eu(t))).reduce(((t,e)=>t.concat(e))):Ho():[]}function Su(t){return{before:t.before,values:t.position}}function ku(t){const e=!!t.before,n=t.values||[];return new tc(n,e)}function Au(t){return du[t]}function Cu(t){return fu[t]}function Nu(t){return{fieldPath:t.canonicalString()}}function Du(t){return fa.fromServerFormat(t.fieldPath)}function Ru(t){return Ha.create(Du(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ho()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ou(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Du(t.unaryFilter.field);return Ha.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Du(t.unaryFilter.field);return Ha.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Du(t.unaryFilter.field);return Ha.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Du(t.unaryFilter.field);return Ha.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ho()}}function Pu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Lu(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=xu(e)),e=Mu(t.get(n),e);return xu(e)}function Mu(t,e){let n=e;const r=t.length;for(let e=0;e<r;e++){const r=t.charAt(e);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function xu(t){return t+""}class Uu{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}Uu.store="owner",Uu.key="owner";class Fu{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}Fu.store="mutationQueues",Fu.keyPath="userId";class Vu{constructor(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}Vu.store="mutations",Vu.keyPath="batchId",Vu.userMutationsIndex="userMutationsIndex",Vu.userMutationsKeyPath=["userId","batchId"];class ju{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Lu(e)]}static key(t,e,n){return[t,Lu(e),n]}}ju.store="documentMutations",ju.PLACEHOLDER=new ju;class Bu{constructor(t,e,n,r,i,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}Bu.store="remoteDocuments",Bu.readTimeIndex="readTimeIndex",Bu.readTimeIndexPath="readTime",Bu.collectionReadTimeIndex="collectionReadTimeIndex",Bu.collectionReadTimeIndexPath=["parentPath","readTime"];class qu{constructor(t){this.byteSize=t}}qu.store="remoteDocumentGlobal",qu.key="remoteDocumentGlobalKey";class zu{constructor(t,e,n,r,i,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}zu.store="targets",zu.keyPath="targetId",zu.queryTargetsIndexName="queryTargetsIndex",zu.queryTargetsKeyPath=["canonicalId","targetId"];class Ku{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}Ku.store="targetDocuments",Ku.keyPath=["targetId","path"],Ku.documentTargetsIndex="documentTargetsIndex",Ku.documentTargetsKeyPath=["path","targetId"];class Hu{constructor(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}Hu.key="targetGlobalKey",Hu.store="targetGlobal";class $u{constructor(t,e){this.collectionId=t,this.parent=e}}$u.store="collectionParents",$u.keyPath=["collectionId","parent"];class Gu{constructor(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}}Gu.store="clientMetadata",Gu.keyPath="clientId";class Wu{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}Wu.store="bundles",Wu.keyPath="bundleId";class Ju{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}Ju.store="namedQueries",Ju.keyPath="name",Fu.store,Vu.store,ju.store,Bu.store,zu.store,Uu.store,Hu.store,Ku.store,Gu.store,qu.store,$u.store,Wu.store,Ju.store;class Xu{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ho(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Xu(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Xu?e:Xu.resolve(e)}catch(t){return Xu.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Xu.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Xu.reject(e)}static resolve(t){return new Xu(((e,n)=>{e(t)}))}static reject(t){return new Xu(((e,n)=>{n(t)}))}static waitFor(t){return new Xu(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=Xu.resolve(!1);for(const n of t)e=e.next((t=>t?Xu.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}}function Qu(t){return"IndexedDbTransactionError"===t.name}class Yu{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&Rc(r,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&Oc(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&Oc(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(aa.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),tu())}isEqual(t){return this.batchId===t.batchId&&sa(this.mutations,t.mutations,((t,e)=>Pc(t,e)))&&sa(this.baseMutations,t.baseMutations,((t,e)=>Pc(t,e)))}}class Zu{constructor(t,e,n,r,i=aa.min(),s=aa.min(),o=pa.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new Zu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Zu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Zu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class th{constructor(t){this.Wt=t}}function eh(t){const e=_u({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new oc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class nh{constructor(){this.Gt=new rh}addToCollectionParentIndex(t,e){return this.Gt.add(e),Xu.resolve()}getCollectionParents(t,e){return Xu.resolve(this.Gt.getEntries(e))}}class rh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Gc(la.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new Gc(la.comparator)).toArray()}}class ih{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new ih(t,ih.DEFAULT_COLLECTION_PERCENTILE,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ih.DEFAULT_COLLECTION_PERCENTILE=10,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ih.DEFAULT=new ih(41943040,ih.DEFAULT_COLLECTION_PERCENTILE,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ih.DISABLED=new ih(-1,0,0);class sh{constructor(t){this.ne=t}next(){return this.ne+=2,this.ne}static se(){return new sh(0)}static ie(){return new sh(-1)}}async function oh(t){if(t.code!==Wo.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;Bo("LocalStore","Unexpectedly lost primary lease")}class ah{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1}forEach(t){ua(this.inner,((e,n)=>{for(const[e,r]of n)t(e,r)}))}isEmpty(){return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(this.inner)}}class ch{constructor(t,e,n){this.He=t,this.In=e,this.Ht=n}An(t,e){return this.In.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Rn(t,e,n)))}Rn(t,e,n){return this.He.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}bn(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}Pn(t,e){return this.He.getEntries(t,e).next((e=>this.vn(t,e).next((()=>e))))}vn(t,e){return this.In.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.bn(e,t)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Ea.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Vn(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Sn(t,e,n):this.Dn(t,e,n)}Vn(t,e){return this.An(t,new Ea(e)).next((t=>{let e=Yc();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Sn(t,e,n){const r=e.collectionGroup;let i=Yc();return this.Ht.getCollectionParents(t,r).next((s=>Xu.forEach(s,(s=>{const o=function(t,e){return new oc(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(r));return this.Dn(t,o,n).next((t=>{t.forEach(((t,e)=>{i=i.insert(t,e)}))}))})).next((()=>i))))}Dn(t,e,n){let r,i;return this.He.getDocumentsMatchingQuery(t,e,n).next((n=>(r=n,this.In.getAllMutationBatchesAffectingQuery(t,e)))).next((e=>(i=e,this.Cn(t,i,r).next((t=>{r=t;for(const t of i)for(const e of t.mutations){const n=e.key;let i=r.get(n);null==i&&(i=Va.newInvalidDocument(n),r=r.insert(n,i)),Oc(e,i,t.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((t,n)=>{gc(e,n)||(r=r.remove(t))})),r)))}Cn(t,e,n){let r=tu();for(const t of e)for(const e of t.mutations)e instanceof xc&&null===n.get(e.key)&&(r=r.add(e.key));let i=n;return this.He.getEntries(t,r).next((t=>(t.forEach(((t,e)=>{e.isFoundDocument()&&(i=i.insert(t,e))})),i)))}}class uh{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Nn=n,this.xn=r}static kn(t,e){let n=tu(),r=tu();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new uh(t,e.fromCache,n,r)}}class hh{$n(t){this.On=t}getDocumentsMatchingQuery(t,e,n,r){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(aa.min())?this.Fn(t,e):this.On.Pn(t,r).next((i=>{const s=this.Mn(e,i);return(cc(e)||uc(e))&&this.Ln(e.limitType,s,r,n)?this.Fn(t,e):(jo()<=L.DEBUG&&Bo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),pc(e)),this.On.getDocumentsMatchingQuery(t,e,n).next((t=>(s.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}Mn(t,e){let n=new Gc(mc(t));return e.forEach(((e,r)=>{gc(t,r)&&(n=n.add(r))})),n}Ln(t,e,n,r){if(n.size!==e.size)return!0;const i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Fn(t,e){return jo()<=L.DEBUG&&Bo("QueryEngine","Using full collection scan to execute query:",pc(e)),this.On.getDocumentsMatchingQuery(t,e,aa.min())}}class lh{constructor(t,e,n,r){this.persistence=t,this.Bn=e,this.N=r,this.Un=new Kc(ia),this.qn=new ah((t=>qa(t)),za),this.Kn=aa.min(),this.In=t.getMutationQueue(n),this.jn=t.getRemoteDocumentCache(),this.ze=t.getTargetCache(),this.Qn=new ch(this.jn,this.In,this.persistence.getIndexManager()),this.Je=t.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Un)))}}async function dh(t,e){const n=Go(t);let r=n.In,i=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.In.getAllMutationBatches(t).next((o=>(s=o,r=n.persistence.getMutationQueue(e),i=new ch(n.jn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)))).next((e=>{const n=[],r=[];let o=tu();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return i.Pn(t,o).next((t=>({Wn:t,removedBatchIds:n,addedBatchIds:r})))}))}));return n.In=r,n.Qn=i,n.Bn.$n(n.Qn),s}function fh(t){const e=Go(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.ze.getLastRemoteSnapshotVersion(t)))}async function ph(t,e,n){const r=Go(t),i=r.Un.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(t=>r.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!Qu(t))throw t;Bo("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}r.Un=r.Un.remove(e),r.qn.delete(i.target)}function gh(t,e,n){const r=Go(t);let i=aa.min(),s=tu();return r.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const r=Go(t),i=r.qn.get(n);return void 0!==i?Xu.resolve(r.Un.get(i)):r.ze.getTargetData(e,n)}(r,t,lc(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>r.Bn.getDocumentsMatchingQuery(t,e,n?i:aa.min(),n?s:tu()))).next((t=>({documents:t,Gn:s})))))}class mh{constructor(t){this.N=t,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(t,e){return Xu.resolve(this.Yn.get(e))}saveBundleMetadata(t,e){var n;return this.Yn.set(e.id,{id:(n=e).id,version:n.version,createTime:gu(n.createTime)}),Xu.resolve()}getNamedQuery(t,e){return Xu.resolve(this.Xn.get(e))}saveNamedQuery(t,e){return this.Xn.set(e.name,function(t){return{name:t.name,query:eh(t.bundledQuery),readTime:gu(t.readTime)}}(e)),Xu.resolve()}}class yh{constructor(){this.Zn=new Gc(vh.ts),this.es=new Gc(vh.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,e){const n=new vh(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.rs(new vh(t,e))}os(t,e){t.forEach((t=>this.removeReference(t,e)))}cs(t){const e=new Ea(new la([])),n=new vh(e,t),r=new vh(e,t+1),i=[];return this.es.forEachInRange([n,r],(t=>{this.rs(t),i.push(t.key)})),i}us(){this.Zn.forEach((t=>this.rs(t)))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const e=new Ea(new la([])),n=new vh(e,t),r=new vh(e,t+1);let i=tu();return this.es.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new vh(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class vh{constructor(t,e){this.key=t,this.ls=e}static ts(t,e){return Ea.comparator(t.key,e.key)||ia(t.ls,e.ls)}static ns(t,e){return ia(t.ls,e.ls)||Ea.comparator(t.key,e.key)}}class wh{constructor(t,e){this.Ht=t,this.referenceDelegate=e,this.In=[],this.fs=1,this.ds=new Gc(vh.ts)}checkEmpty(t){return Xu.resolve(0===this.In.length)}addMutationBatch(t,e,n,r){const i=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const s=new Yu(i,e,n,r);this.In.push(s);for(const e of r)this.ds=this.ds.add(new vh(e.key,i)),this.Ht.addToCollectionParentIndex(t,e.key.path.popLast());return Xu.resolve(s)}lookupMutationBatch(t,e){return Xu.resolve(this.ws(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this._s(n),i=r<0?0:r;return Xu.resolve(this.In.length>i?this.In[i]:null)}getHighestUnacknowledgedBatchId(){return Xu.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(t){return Xu.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new vh(e,0),r=new vh(e,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],(t=>{const e=this.ws(t.ls);i.push(e)})),Xu.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Gc(ia);return e.forEach((t=>{const e=new vh(t,0),r=new vh(t,Number.POSITIVE_INFINITY);this.ds.forEachInRange([e,r],(t=>{n=n.add(t.ls)}))})),Xu.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;Ea.isDocumentKey(i)||(i=i.child(""));const s=new vh(new Ea(i),0);let o=new Gc(ia);return this.ds.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.ls)),!0)}),s),Xu.resolve(this.gs(o))}gs(t){const e=[];return t.forEach((t=>{const n=this.ws(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){$o(0===this.ys(e.batchId,"removed")),this.In.shift();let n=this.ds;return Xu.forEach(e.mutations,(r=>{const i=new vh(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.ds=n}))}te(t){}containsKey(t,e){const n=new vh(e,0),r=this.ds.firstAfterOrEqual(n);return Xu.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.In.length,Xu.resolve()}ys(t,e){return this._s(t)}_s(t){return 0===this.In.length?0:t-this.In[0].batchId}ws(t){const e=this._s(t);return e<0||e>=this.In.length?null:this.In[e]}}class Ih{constructor(t,e){this.Ht=t,this.ps=e,this.docs=new Kc(Ea.comparator),this.size=0}addEntry(t,e,n){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.ps(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:o,readTime:n}),this.size+=o-s,this.Ht.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Xu.resolve(n?n.document.clone():Va.newInvalidDocument(e))}getEntries(t,e){let n=Xc();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.clone():Va.newInvalidDocument(t))})),Xu.resolve(n)}getDocumentsMatchingQuery(t,e,n){let r=Xc();const i=new Ea(e.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:t,value:{document:i,readTime:o}}=s.getNext();if(!e.path.isPrefixOf(t.path))break;o.compareTo(n)<=0||gc(e,i)&&(r=r.insert(i.key,i.clone()))}return Xu.resolve(r)}Es(t,e){return Xu.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new bh(this)}getSize(t){return Xu.resolve(this.size)}}class bh extends class{constructor(){this.changes=new ah((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}getReadTime(t){const e=this.changes.get(t);return e?e.readTime:aa.min()}addEntry(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}removeEntry(t,e=null){this.assertNotApplied(),this.changes.set(t,{document:Va.newInvalidDocument(t),readTime:e})}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Xu.resolve(n.document):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Se=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?e.push(this.Se.addEntry(t,r.document,this.getReadTime(n))):this.Se.removeEntry(n)})),Xu.waitFor(e)}getFromCache(t,e){return this.Se.getEntry(t,e)}getAllFromCache(t,e){return this.Se.getEntries(t,e)}}class Th{constructor(t){this.persistence=t,this.Ts=new ah((t=>qa(t)),za),this.lastRemoteSnapshotVersion=aa.min(),this.highestTargetId=0,this.Is=0,this.As=new yh,this.targetCount=0,this.Rs=sh.se()}forEachTarget(t,e){return this.Ts.forEach(((t,n)=>e(n))),Xu.resolve()}getLastRemoteSnapshotVersion(t){return Xu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Xu.resolve(this.Is)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),Xu.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Is&&(this.Is=e),Xu.resolve()}ae(t){this.Ts.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Rs=new sh(e),this.highestTargetId=e),t.sequenceNumber>this.Is&&(this.Is=t.sequenceNumber)}addTargetData(t,e){return this.ae(e),this.targetCount+=1,Xu.resolve()}updateTargetData(t,e){return this.ae(e),Xu.resolve()}removeTargetData(t,e){return this.Ts.delete(e.target),this.As.cs(e.targetId),this.targetCount-=1,Xu.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),Xu.waitFor(i).next((()=>r))}getTargetCount(t){return Xu.resolve(this.targetCount)}getTargetData(t,e){const n=this.Ts.get(e)||null;return Xu.resolve(n)}addMatchingKeys(t,e,n){return this.As.ss(e,n),Xu.resolve()}removeMatchingKeys(t,e,n){this.As.os(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),Xu.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.As.cs(e),Xu.resolve()}getMatchingKeysForTargetId(t,e){const n=this.As.hs(e);return Xu.resolve(n)}containsKey(t,e){return Xu.resolve(this.As.containsKey(e))}}class _h{constructor(t,e){this.bs={},this.Le=new na(0),this.Be=!1,this.Be=!0,this.referenceDelegate=t(this),this.ze=new Th(this),this.Ht=new nh,this.He=function(t,e){return new Ih(t,e)}(this.Ht,(t=>this.referenceDelegate.Ps(t))),this.N=new th(e),this.Je=new mh(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(t){let e=this.bs[t.toKey()];return e||(e=new wh(this.Ht,this.referenceDelegate),this.bs[t.toKey()]=e),e}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(t,e,n){Bo("MemoryPersistence","Starting transaction:",t);const r=new Eh(this.Le.next());return this.referenceDelegate.vs(),n(r).next((t=>this.referenceDelegate.Vs(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Ss(t,e){return Xu.or(Object.values(this.bs).map((n=>()=>n.containsKey(t,e))))}}class Eh extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class Sh{constructor(t){this.persistence=t,this.Ds=new yh,this.Cs=null}static Ns(t){return new Sh(t)}get xs(){if(this.Cs)return this.Cs;throw Ho()}addReference(t,e,n){return this.Ds.addReference(n,e),this.xs.delete(n.toString()),Xu.resolve()}removeReference(t,e,n){return this.Ds.removeReference(n,e),this.xs.add(n.toString()),Xu.resolve()}markPotentiallyOrphaned(t,e){return this.xs.add(e.toString()),Xu.resolve()}removeTarget(t,e){this.Ds.cs(e.targetId).forEach((t=>this.xs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.xs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}vs(){this.Cs=new Set}Vs(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xu.forEach(this.xs,(n=>{const r=Ea.fromPath(n);return this.ks(t,r).next((t=>{t||e.removeEntry(r)}))})).next((()=>(this.Cs=null,e.apply(t))))}updateLimboDocument(t,e){return this.ks(t,e).next((t=>{t?this.xs.delete(e.toString()):this.xs.add(e.toString())}))}Ps(t){return 0}ks(t,e){return Xu.or([()=>Xu.resolve(this.Ds.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ss(t,e)])}}class kh{constructor(){this.activeTargetIds=nu()}Fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ms(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Os(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ah{constructor(){this.yi=new kh,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.yi.Fs(t),this.pi[t]||"not-current"}updateQueryState(t,e,n){this.pi[t]=e}removeLocalQueryTarget(t){this.yi.Ms(t)}isLocalQueryTarget(t){return this.yi.activeTargetIds.has(t)}clearQueryState(t){delete this.pi[t]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(t){return this.yi.activeTargetIds.has(t)}start(){return this.yi=new kh,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class Ch{Ei(t){}shutdown(){}}class Nh{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ei(t){this.bi.push(t)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){Bo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.bi)t(0)}Ri(){Bo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.bi)t(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Dh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Rh{constructor(t){this.vi=t.vi,this.Vi=t.Vi}Si(t){this.Di=t}Ci(t){this.Ni=t}onMessage(t){this.xi=t}close(){this.Vi()}send(t){this.vi(t)}ki(){this.Di()}$i(t){this.Ni(t)}Oi(t){this.xi(t)}}class Oh extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.Fi=e+"://"+t.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(t,e,n,r){const i=this.Bi(t,e);Bo("RestConnection","Sending: ",i,n);const s={};return this.Ui(s,r),this.qi(t,i,s,n).then((t=>(Bo("RestConnection","Received: ",t),t)),(e=>{throw zo("RestConnection",`${t} failed with error: `,e,"url: ",i,"request:",n),e}))}Ki(t,e,n,r){return this.Li(t,e,n,r)}Ui(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+Fo,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(const n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])}Bi(t,e){const n=Dh[t];return`${this.Fi}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}qi(t,e,n,r){return new Promise(((i,s)=>{const o=new xo;o.listenOnce(Do.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case No.NO_ERROR:const e=o.getResponseJson();Bo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case No.TIMEOUT:Bo("Connection",'RPC "'+t+'" timed out'),s(new Jo(Wo.DEADLINE_EXCEEDED,"Request time out"));break;case No.HTTP_ERROR:const n=o.getStatus();if(Bo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Wo).indexOf(e)>=0?e:Wo.UNKNOWN}(t.status);s(new Jo(e,t.message))}else s(new Jo(Wo.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Jo(Wo.UNAVAILABLE,"Connection failed."));break;default:Ho()}}finally{Bo("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(r);o.send(e,"POST",a,n,15)}))}ji(t,e){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Eo,i=mi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Lo({})),this.Ui(s.initMessageHeaders,e),u()||l()||c().indexOf("Electron/")>=0||d()||c().indexOf("MSAppHost/")>=0||h()||(s.httpHeadersOverwriteParam="$httpHeaders");const o=n.join("");Bo("Connection","Creating WebChannel: "+o,s);const a=r.createWebChannel(o,s);let f=!1,p=!1;const g=new Rh({vi:t=>{p?Bo("Connection","Not sending because WebChannel is closed:",t):(f||(Bo("Connection","Opening WebChannel transport."),a.open(),f=!0),Bo("Connection","WebChannel sending:",t),a.send(t))},Vi:()=>a.close()}),m=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return m(a,Mo.EventType.OPEN,(()=>{p||Bo("Connection","WebChannel transport opened.")})),m(a,Mo.EventType.CLOSE,(()=>{p||(p=!0,Bo("Connection","WebChannel transport closed"),g.$i())})),m(a,Mo.EventType.ERROR,(t=>{p||(p=!0,zo("Connection","WebChannel transport errored:",t),g.$i(new Jo(Wo.UNAVAILABLE,"The operation could not be completed")))})),m(a,Mo.EventType.MESSAGE,(t=>{var e;if(!p){const n=t.data[0];$o(!!n);const r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Bo("Connection","WebChannel received error:",i);const t=i.status;let e=function(t){const e=Bc[t];if(void 0!==e)return zc(e)}(t),n=i.message;void 0===e&&(e=Wo.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),p=!0,g.$i(new Jo(e,n)),a.close()}else Bo("Connection","WebChannel received:",n),g.Oi(n)}})),m(i,Ro.STAT_EVENT,(t=>{t.stat===Oo?Bo("Connection","Detected buffering proxy"):t.stat===Po&&Bo("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.ki()}),0),g}}function Ph(){return"undefined"!=typeof document?document:null}function Lh(t){return new pu(t,!0)}class Mh{constructor(t,e,n=1e3,r=1.5,i=6e4){this.Oe=t,this.timerId=e,this.Qi=n,this.Wi=r,this.Gi=i,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(t){this.cancel();const e=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),r=Math.max(0,e-n);r>0&&Bo("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zi} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,r,(()=>(this.Ji=Date.now(),t()))),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class xh extends class{constructor(t,e,n,r,i,s){this.Oe=t,this.er=n,this.nr=r,this.credentialsProvider=i,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Mh(t,e)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,(()=>this.dr())))}wr(t){this._r(),this.stream.send(t)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(t,e){this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===Wo.RESOURCE_EXHAUSTED?(qo(e.toString()),qo("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):e&&e.code===Wo.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ci(e)}mr(){}auth(){this.state=1;const t=this.gr(this.sr),e=this.sr;this.credentialsProvider.getToken().then((t=>{this.sr===e&&this.yr(t)}),(e=>{t((()=>{const t=new Jo(Wo.UNKNOWN,"Fetching auth token failed: "+e.message);return this.pr(t)}))}))}yr(t){const e=this.gr(this.sr);this.stream=this.Er(t),this.stream.Si((()=>{e((()=>(this.state=2,this.listener.Si())))})),this.stream.Ci((t=>{e((()=>this.pr(t)))})),this.stream.onMessage((t=>{e((()=>this.onMessage(t)))}))}ur(){this.state=4,this.rr.Xi((async()=>{this.state=0,this.start()}))}pr(t){return Bo("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(3,t)}gr(t){return e=>{this.Oe.enqueueAndForget((()=>this.sr===t?e():(Bo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}{constructor(t,e,n,r,i){super(t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i),this.N=r}Er(t){return this.nr.ji("Listen",t)}onMessage(t){this.rr.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ho()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.D?($o(void 0===e||"string"==typeof e),pa.fromBase64String(e||"")):($o(void 0===e||e instanceof Uint8Array),pa.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Wo.UNKNOWN:zc(t.code);return new Jo(e,t.message||"")}(o);n=new au(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=yu(t,r.document.name),s=gu(r.document.updateTime),o=new Fa({mapValue:{fields:r.document.fields}}),a=Va.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new su(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=yu(t,r.document),s=r.readTime?gu(r.readTime):aa.min(),o=Va.newNoDocument(i,s),a=r.removedTargetIds||[];n=new su([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=yu(t,r.document),s=r.removedTargetIds||[];n=new su([],s,i,null)}else{if(!("filter"in e))return Ho();{e.filter;const t=e.filter;t.targetId;const r=t.count||0,i=new jc(r),s=t.targetId;n=new ou(s,i)}}return n}(this.N,t),n=function(t){if(!("targetChange"in t))return aa.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?aa.min():e.readTime?gu(e.readTime):aa.min()}(t);return this.listener.Tr(e,n)}Ir(t){const e={};e.database=wu(this.N),e.addTarget=function(t,e){let n;const r=e.target;return n=Ka(r)?{documents:bu(t,r)}:{query:Tu(t,r)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=function(t,e){return t.D?e.toBase64():e.toUint8Array()}(t,e.resumeToken):e.snapshotVersion.compareTo(aa.min())>0&&(n.readTime=function(t,e){return t.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}(t,e.snapshotVersion.toTimestamp())),n}(this.N,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ho()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.N,t);n&&(e.labels=n),this.wr(e)}Ar(t){const e={};e.database=wu(this.N),e.removeTarget=t,this.wr(e)}}class Uh extends class{}{constructor(t,e,n){super(),this.credentials=t,this.nr=e,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new Jo(Wo.FAILED_PRECONDITION,"The client has already been terminated.")}Li(t,e,n){return this.Cr(),this.credentials.getToken().then((r=>this.nr.Li(t,e,n,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Wo.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new Jo(Wo.UNKNOWN,t.toString())}))}Ki(t,e,n){return this.Cr(),this.credentials.getToken().then((r=>this.nr.Ki(t,e,n,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Wo.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new Jo(Wo.UNKNOWN,t.toString())}))}terminate(){this.Dr=!0}}class Fh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve()))))}Lr(t){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Fr("Offline")))}set(t){this.Br(),this.Nr=0,"Online"===t&&(this.$r=!1),this.Fr(t)}Fr(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Mr(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(qo(e),this.$r=!1):Bo("OnlineStateTracker",e)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class Vh{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=i,this.Qr.Ei((t=>{n.enqueueAndForget((async()=>{Wh(this)&&(Bo("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Go(t);e.Kr.add(4),await Bh(e),e.Wr.set("Unknown"),e.Kr.delete(4),await jh(e)}(this))}))})),this.Wr=new Fh(n,r)}}async function jh(t){if(Wh(t))for(const e of t.jr)await e(!0)}async function Bh(t){for(const e of t.jr)await e(!1)}function qh(t,e){const n=Go(t);n.qr.has(e.targetId)||(n.qr.set(e.targetId,e),Gh(n)?$h(n):tl(n).cr()&&Kh(n,e))}function zh(t,e){const n=Go(t),r=tl(n);n.qr.delete(e),r.cr()&&Hh(n,e),0===n.qr.size&&(r.cr()?r.lr():Wh(n)&&n.Wr.set("Unknown"))}function Kh(t,e){t.Gr.Y(e.targetId),tl(t).Ir(e)}function Hh(t,e){t.Gr.Y(e),tl(t).Ar(e)}function $h(t){t.Gr=new uu({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.qr.get(e)||null}),tl(t).start(),t.Wr.Or()}function Gh(t){return Wh(t)&&!tl(t).ar()&&t.qr.size>0}function Wh(t){return 0===Go(t).Kr.size}function Jh(t){t.Gr=void 0}async function Xh(t){t.qr.forEach(((e,n)=>{Kh(t,e)}))}async function Qh(t,e){Jh(t),Gh(t)?(t.Wr.Lr(e),$h(t)):t.Wr.set("Unknown")}async function Yh(t,e,n){if(t.Wr.set("Online"),e instanceof au&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.qr.has(r)&&(await t.remoteSyncer.rejectListen(r,n),t.qr.delete(r),t.Gr.removeTarget(r))}(t,e)}catch(n){Bo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Zh(t,n)}else if(e instanceof su?t.Gr.rt(e):e instanceof ou?t.Gr.ft(e):t.Gr.ct(e),!n.isEqual(aa.min()))try{const e=await fh(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Gr._t(e);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.qr.get(r);i&&t.qr.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.qr.get(e);if(!n)return;t.qr.set(e,n.withResumeToken(pa.EMPTY_BYTE_STRING,n.snapshotVersion)),Hh(t,e);const r=new Zu(n.target,e,1,n.sequenceNumber);Kh(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Bo("RemoteStore","Failed to raise snapshot:",e),await Zh(t,e)}}async function Zh(t,e,n){if(!Qu(e))throw e;t.Kr.add(1),await Bh(t),t.Wr.set("Offline"),n||(n=()=>fh(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Bo("RemoteStore","Retrying IndexedDB access"),await n(),t.Kr.delete(1),await jh(t)}))}function tl(t){return t.zr||(t.zr=function(t,e,n){const r=Go(t);return r.Cr(),new xh(e,r.nr,r.credentials,r.N,n)}(t.datastore,t.asyncQueue,{Si:Xh.bind(null,t),Ci:Qh.bind(null,t),Tr:Yh.bind(null,t)}),t.jr.push((async e=>{e?(t.zr.hr(),Gh(t)?$h(t):t.Wr.set("Unknown")):(await t.zr.stop(),Jh(t))}))),t.zr}class el{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Xo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new el(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Jo(Wo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nl(t,e){if(qo("AsyncQueue",`${e}: ${t}`),Qu(t))return new Jo(Wo.UNAVAILABLE,`${e}: ${t}`);throw t}class rl{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ea.comparator(e.key,n.key):(t,e)=>Ea.comparator(t.key,e.key),this.keyedMap=Yc(),this.sortedSet=new Kc(this.comparator)}static emptySet(t){return new rl(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof rl))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new rl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class il{constructor(){this.Jr=new Kc(Ea.comparator)}track(t){const e=t.doc.key,n=this.Jr.get(e);n?0!==t.type&&3===n.type?this.Jr=this.Jr.insert(e,t):3===t.type&&1!==n.type?this.Jr=this.Jr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Jr=this.Jr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Jr=this.Jr.remove(e):1===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):Ho():this.Jr=this.Jr.insert(e,t)}Yr(){const t=[];return this.Jr.inorderTraversal(((e,n)=>{t.push(n)})),t}}class sl{constructor(t,e,n,r,i,s,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(t,e,n,r){const i=[];return e.forEach((t=>{i.push({type:0,doc:t})})),new sl(t,e,rl.emptySet(e),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&dc(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class ol{constructor(){this.Xr=void 0,this.listeners=[]}}class al{constructor(){this.queries=new ah((t=>fc(t)),dc),this.onlineState="Unknown",this.Zr=new Set}}function cl(t,e){const n=Go(t);let r=!1;for(const t of e){const e=t.query,i=n.queries.get(e);if(i){for(const e of i.listeners)e.no(t)&&(r=!0);i.Xr=t}}r&&hl(n)}function ul(t,e,n){const r=Go(t),i=r.queries.get(e);if(i)for(const t of i.listeners)t.onError(n);r.queries.delete(e)}function hl(t){t.Zr.forEach((t=>{t.next()}))}class ll{constructor(t,e,n){this.query=t,this.so=e,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}no(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new sl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let e=!1;return this.io?this.oo(t)&&(this.so.next(t),e=!0):this.ao(t,this.onlineState)&&(this.co(t),e=!0),this.ro=t,e}onError(t){this.so.error(t)}eo(t){this.onlineState=t;let e=!1;return this.ro&&!this.io&&this.ao(this.ro,t)&&(this.co(this.ro),e=!0),e}ao(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options.uo&&n||t.docs.isEmpty()&&"Offline"!==e)}oo(t){if(t.docChanges.length>0)return!0;const e=this.ro&&this.ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}co(t){t=sl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.io=!0,this.so.next(t)}}class dl{constructor(t){this.key=t}}class fl{constructor(t){this.key=t}}class pl{constructor(t,e){this.query=t,this._o=e,this.mo=null,this.current=!1,this.yo=tu(),this.mutatedKeys=tu(),this.po=mc(t),this.Eo=new rl(this.po)}get To(){return this._o}Io(t,e){const n=e?e.Ao:new il,r=e?e.Eo:this.Eo;let i=e?e.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=cc(this.query)&&r.size===this.query.limit?r.last():null,c=uc(this.query)&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal(((t,e)=>{const u=r.get(t),h=gc(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Ro(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.po(h,a)>0||c&&this.po(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),i=d?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))})),cc(this.query)||uc(this.query))for(;s.size>this.query.limit;){const t=cc(this.query)?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{Eo:s,Ao:n,Ln:o,mutatedKeys:i}}Ro(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const r=this.Eo;this.Eo=t.Eo,this.mutatedKeys=t.mutatedKeys;const i=t.Ao.Yr();i.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ho()}};return n(t)-n(e)}(t.type,e.type)||this.po(t.doc,e.doc))),this.bo(n);const s=e?this.Po():[],o=0===this.yo.size&&this.current?1:0,a=o!==this.mo;return this.mo=o,0!==i.length||a?{snapshot:new sl(this.query,t.Eo,r,i,t.mutatedKeys,0===o,a,!1),vo:s}:{vo:s}}eo(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new il,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(t){return!this._o.has(t)&&!!this.Eo.has(t)&&!this.Eo.get(t).hasLocalMutations}bo(t){t&&(t.addedDocuments.forEach((t=>this._o=this._o.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this._o=this._o.delete(t))),this.current=t.current)}Po(){if(!this.current)return[];const t=this.yo;this.yo=tu(),this.Eo.forEach((t=>{this.Vo(t.key)&&(this.yo=this.yo.add(t.key))}));const e=[];return t.forEach((t=>{this.yo.has(t)||e.push(new fl(t))})),this.yo.forEach((n=>{t.has(n)||e.push(new dl(n))})),e}So(t){this._o=t.Gn,this.yo=tu();const e=this.Io(t.documents);return this.applyChanges(e,!0)}Do(){return sl.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)}}class gl{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class ml{constructor(t){this.key=t,this.Co=!1}}class yl{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.No={},this.xo=new ah((t=>fc(t)),dc),this.ko=new Map,this.$o=new Set,this.Oo=new Kc(Ea.comparator),this.Fo=new Map,this.Mo=new yh,this.Lo={},this.Bo=new Map,this.Uo=sh.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}async function vl(t,e){const n=function(t){const e=Go(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Il.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Tl.bind(null,e),e.No.Tr=cl.bind(null,e.eventManager),e.No.jo=ul.bind(null,e.eventManager),e}(t);let r,i;const s=n.xo.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Do();else{const t=await function(t,e){const n=Go(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let r;return n.ze.getTargetData(t,e).next((i=>i?(r=i,Xu.resolve(r)):n.ze.allocateTargetId(t).next((i=>(r=new Zu(e,i,0,t.currentSequenceNumber),n.ze.addTargetData(t,r).next((()=>r)))))))})).then((t=>{const r=n.Un.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(t.targetId,t),n.qn.set(e,t.targetId)),t}))}(n.localStore,lc(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);r=t.targetId,i=await async function(t,e,n,r){t.Ko=(e,n,r)=>async function(t,e,n,r){let i=e.view.Io(n);i.Ln&&(i=await gh(t.localStore,e.query,!1).then((({documents:t})=>e.view.Io(t,i))));const s=r&&r.targetChanges.get(e.targetId),o=e.view.applyChanges(i,t.isPrimaryClient,s);return Sl(t,e.targetId,o.vo),o.snapshot}(t,e,n,r);const i=await gh(t.localStore,e,!0),s=new pl(e,i.Gn),o=s.Io(i.documents),a=iu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),c=s.applyChanges(o,t.isPrimaryClient,a);Sl(t,n,c.vo);const u=new gl(e,n,s);return t.xo.set(e,u),t.ko.has(n)?t.ko.get(n).push(e):t.ko.set(n,[e]),c.snapshot}(n,e,r,"current"===s),n.isPrimaryClient&&qh(n.remoteStore,t)}return i}async function wl(t,e){const n=Go(t),r=n.xo.get(e),i=n.ko.get(r.targetId);if(i.length>1)return n.ko.set(r.targetId,i.filter((t=>!dc(t,e)))),void n.xo.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ph(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),zh(n.remoteStore,r.targetId),_l(n,r.targetId)})).catch(oh)):(_l(n,r.targetId),await ph(n.localStore,r.targetId,!0))}async function Il(t,e){const n=Go(t);try{const t=await function(t,e){const n=Go(t),r=e.snapshotVersion;let i=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.jn.newChangeBuffer({trackRemovals:!0});i=n.Un;const o=[];e.targetChanges.forEach(((e,s)=>{const a=i.get(s);if(!a)return;o.push(n.ze.removeMatchingKeys(t,e.removedDocuments,s).next((()=>n.ze.addMatchingKeys(t,e.addedDocuments,s))));const c=e.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(s,u),function(t,e,n){return $o(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,e)&&o.push(n.ze.updateTargetData(t,u))}}));let a=Xc();if(e.documentUpdates.forEach(((r,i)=>{e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),o.push(function(t,e,n,r,i){let s=tu();return n.forEach((t=>s=s.add(t))),e.getEntries(t,s).next((t=>{let s=Xc();return n.forEach(((n,o)=>{const a=t.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(aa.min())?(e.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(o,c),s=s.insert(n,o)):Bo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}(t,s,e.documentUpdates,r,void 0).next((t=>{a=t}))),!r.isEqual(aa.min())){const e=n.ze.getLastRemoteSnapshotVersion(t).next((e=>n.ze.setTargetsMetadata(t,t.currentSequenceNumber,r)));o.push(e)}return Xu.waitFor(o).next((()=>s.apply(t))).next((()=>n.Qn.vn(t,a))).next((()=>a))})).then((t=>(n.Un=i,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const r=n.Fo.get(e);r&&($o(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.Co=!0:t.modifiedDocuments.size>0?$o(r.Co):t.removedDocuments.size>0&&($o(r.Co),r.Co=!1))})),await Cl(n,t,e)}catch(t){await oh(t)}}function bl(t,e,n){const r=Go(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.xo.forEach(((n,r)=>{const i=r.view.eo(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=Go(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.eo(e)&&(r=!0)})),r&&hl(n)}(r.eventManager,e),t.length&&r.No.Tr(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Tl(t,e,n){const r=Go(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Fo.get(e),s=i&&i.key;if(s){let t=new Kc(Ea.comparator);t=t.insert(s,Va.newNoDocument(s,aa.min()));const n=tu().add(s),i=new ru(aa.min(),new Map,new Gc(ia),t,n);await Il(r,i),r.Oo=r.Oo.remove(s),r.Fo.delete(e),Al(r)}else await ph(r.localStore,e,!1).then((()=>_l(r,e,n))).catch(oh)}function _l(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ko.get(e))t.xo.delete(r),n&&t.No.jo(r,n);t.ko.delete(e),t.isPrimaryClient&&t.Mo.cs(e).forEach((e=>{t.Mo.containsKey(e)||El(t,e)}))}function El(t,e){t.$o.delete(e.path.canonicalString());const n=t.Oo.get(e);null!==n&&(zh(t.remoteStore,n),t.Oo=t.Oo.remove(e),t.Fo.delete(n),Al(t))}function Sl(t,e,n){for(const r of n)r instanceof dl?(t.Mo.addReference(r.key,e),kl(t,r)):r instanceof fl?(Bo("SyncEngine","Document no longer in limbo: "+r.key),t.Mo.removeReference(r.key,e),t.Mo.containsKey(r.key)||El(t,r.key)):Ho()}function kl(t,e){const n=e.key,r=n.path.canonicalString();t.Oo.get(n)||t.$o.has(r)||(Bo("SyncEngine","New document in limbo: "+n),t.$o.add(r),Al(t))}function Al(t){for(;t.$o.size>0&&t.Oo.size<t.maxConcurrentLimboResolutions;){const e=t.$o.values().next().value;t.$o.delete(e);const n=new Ea(la.fromString(e)),r=t.Uo.next();t.Fo.set(r,new ml(n)),t.Oo=t.Oo.insert(n,r),qh(t.remoteStore,new Zu(lc(ac(n.path)),r,2,na.T))}}async function Cl(t,e,n){const r=Go(t),i=[],s=[],o=[];r.xo.isEmpty()||(r.xo.forEach(((t,a)=>{o.push(r.Ko(a,e,n).then((t=>{if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);const e=uh.kn(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.No.Tr(i),await async function(t,e){const n=Go(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Xu.forEach(e,(e=>Xu.forEach(e.Nn,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>Xu.forEach(e.xn,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Qu(t))throw t;Bo("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Un.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Un=n.Un.insert(e,i)}}}(r.localStore,s))}async function Nl(t,e){const n=Go(t);if(!n.currentUser.isEqual(e)){Bo("SyncEngine","User change. New user:",e.toKey());const t=await dh(n.localStore,e);n.currentUser=e,function(t,e){t.Bo.forEach((t=>{t.forEach((t=>{t.reject(new Jo(Wo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Cl(n,t.Wn)}}function Dl(t,e){const n=Go(t),r=n.Fo.get(e);if(r&&r.Co)return tu().add(r.key);{let t=tu();const r=n.ko.get(e);if(!r)return t;for(const e of r){const r=n.xo.get(e);t=t.unionWith(r.view.To)}return t}}class Rl{constructor(){this.synchronizeTabs=!1}async initialize(t){this.N=Lh(t.databaseInfo.databaseId),this.sharedClientState=this.Wo(t),this.persistence=this.Go(t),await this.persistence.start(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t)}zo(t){return null}Ho(t){return function(t,e,n,r){return new lh(t,e,n,r)}(this.persistence,new hh,t.initialUser,this.N)}Go(t){return new _h(Sh.Ns,this.N)}Wo(t){return new Ah}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ol{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>bl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Nl.bind(null,this.syncEngine),await async function(t,e){const n=Go(t);e?(n.Kr.delete(2),await jh(n)):e||(n.Kr.add(2),await Bh(n),n.Wr.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new al}createDatastore(t){const e=Lh(t.databaseInfo.databaseId),n=(r=t.databaseInfo,new Oh(r));var r;return function(t,e,n){return new Uh(t,e,n)}(t.credentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=t=>bl(this.syncEngine,t,0),s=Nh.bt()?new Nh:new Ch,new Vh(e,n,r,i,s);var e,n,r,i,s}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new yl(t,e,n,r,i,s);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Go(t);Bo("RemoteStore","RemoteStore shutting down."),e.Kr.add(5),await Bh(e),e.Qr.shutdown(),e.Wr.set("Unknown")}(this.remoteStore)}}class Pl{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Yo(this.observer.next,t)}error(t){this.observer.error?this.Yo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}Xo(){this.muted=!0}Yo(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Ll{constructor(t,e,n){this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Uo.UNAUTHENTICATED,this.clientId=class{static I(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=ra(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(e,(async t=>{Bo("FirestoreClient","Received user=",t.uid),await this.credentialListener(t),this.user=t}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.credentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Jo(Wo.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Xo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),t.resolve()}catch(e){const n=nl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Ml(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Bo("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Bo("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await dh(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Rl)),t.offlineComponents}(t);Bo("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener((t=>async function(t,e){const n=Go(t);n.asyncQueue.verifyOperationInProgress(),Bo("RemoteStore","RemoteStore received new credentials");const r=Wh(n);n.Kr.add(3),await Bh(n),r&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Kr.delete(3),await jh(n)}(e.remoteStore,t))),t.onlineComponents=e}async function xl(t){const e=await async function(t){return t.onlineComponents||(Bo("FirestoreClient","Using default OnlineComponentProvider"),await Ml(t,new Ol)),t.onlineComponents}(t),n=e.eventManager;return n.onListen=vl.bind(null,e.syncEngine),n.onUnlisten=wl.bind(null,e.syncEngine),n}class Ul{constructor(t,e,n,r,i,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Fl{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Fl&&t.projectId===this.projectId&&t.database===this.database}}const Vl=new Map;function jl(t){if(Ea.isDocumentKey(t))throw new Jo(Wo.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Jo(Wo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ho()}(t);throw new Jo(Wo.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ql{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Jo(Wo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Jo(Wo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,r){if(!0===e&&!0===r)throw new Jo(Wo.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class zl{constructor(t,e){this._credentials=e,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ql({}),this._settingsFrozen=!1,t instanceof Fl?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Jo(Wo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fl(t.options.projectId)}(t))}get app(){if(!this._app)throw new Jo(Wo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Jo(Wo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ql(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Yo;switch(t.type){case"gapi":const e=t.client;return $o(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ea(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Jo(Wo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Vl.get(t);e&&(Bo("ComponentProvider","Removing Datastore"),Vl.delete(t),e.terminate())}(this),Promise.resolve()}}class Kl{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $l(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Kl(this.firestore,t,this._key)}}class Hl{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Hl(this.firestore,t,this._query)}}class $l extends Hl{constructor(t,e,n){super(t,e,ac(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Kl(this.firestore,null,new Ea(t))}withConverter(t){return new $l(this.firestore,t,this._path)}}class Gl{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new Mh(this,"async_queue_retry"),this.Ea=()=>{const t=Ph();t&&Bo("AsyncQueue","Visibility state changed to "+t.visibilityState),this.rr.tr()};const t=Ph();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Ta(),this.Ia(t)}enterRestrictedMode(t){if(!this.wa){this.wa=!0,this.ya=t||!1;const e=Ph();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ea)}}enqueue(t){if(this.Ta(),this.wa)return new Promise((()=>{}));const e=new Xo;return this.Ia((()=>this.wa&&this.ya?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.da.push(t),this.Aa())))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(t){if(!Qu(t))throw t;Bo("AsyncQueue","Operation failed with retryable error: "+t)}this.da.length>0&&this.rr.Xi((()=>this.Aa()))}}Ia(t){const e=this.fa.then((()=>(this.ga=!0,t().catch((t=>{throw this.ma=t,this.ga=!1,qo("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((t=>(this.ga=!1,t))))));return this.fa=e,e}enqueueAfterDelay(t,e,n){this.Ta(),this.pa.indexOf(t)>-1&&(e=0);const r=el.createAndSchedule(this,t,e,n,(t=>this.Ra(t)));return this._a.push(r),r}Ta(){this.ma&&Ho()}verifyOperationInProgress(){}async ba(){let t;do{t=this.fa,await t}while(t!==this.fa)}Pa(t){for(const e of this._a)if(e.timerId===t)return!0;return!1}va(t){return this.ba().then((()=>{this._a.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this._a)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.ba()}))}Va(t){this.pa.push(t)}Ra(t){const e=this._a.indexOf(t);this._a.splice(e,1)}}function Wl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of["next","error","complete"])if(t in n&&"function"==typeof n[t])return!0;return!1}(t)}class Jl extends zl{constructor(t,e){super(t,e),this.type="firestore",this._queue=new Gl,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Xl(this),this._firestoreClient.terminate()}}function Xl(t){var e;const n=t._freezeSettings(),r=function(t,e,n,r){return new Ul(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ll(t._credentials,t._queue,r)}class Ql{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Jo(Wo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fa(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Yl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Yl(pa.fromBase64String(t))}catch(t){throw new Jo(Wo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Yl(pa.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Zl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Jo(Wo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Jo(Wo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ia(this._lat,t._lat)||ia(this._long,t._long)}}const td=new RegExp("[~\\*/\\[\\]]");function ed(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Jo(Wo.INVALID_ARGUMENT,a+t+c)}class nd{constructor(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Kl(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new rd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(id("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class rd extends nd{data(){return super.data()}}function id(t,e){return"string"==typeof e?function(t,e,n){if(e.search(td)>=0)throw ed(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ql(...e.split("."))._internalPath}catch(r){throw ed(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e):e instanceof Ql?e._internalPath:e._delegate._internalPath}class sd{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class od extends nd{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ad(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(id("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class ad extends od{data(t={}){return super.data(t)}}class cd{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new sd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new ad(this._firestore,this._userDataWriter,n.key,n,new sd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Jo(Wo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>({type:"added",doc:new ad(t._firestore,t._userDataWriter,n.doc.key,n.doc,new sd(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++})))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const r=new ad(t._firestore,t._userDataWriter,e.doc.key,e.doc,new sd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:ud(e.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function ud(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ho()}}class hd extends class{convertValue(t,e="none"){switch(Sa(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ya(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(va(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ho()}}convertObject(t,e){const n={};return ua(t.fields,((t,r)=>{n[t]=this.convertValue(r,e)})),n}convertGeoPoint(t){return new Zl(ya(t.latitude),ya(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Ia(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ba(t));default:return null}}convertTimestamp(t){const e=ma(t);return new oa(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=la.fromString(t);$o(Pu(n));const r=new Fl(n.get(1),n.get(3)),i=new Ea(n.popFirst(5));return r.isEqual(e)||qo(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new Yl(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Kl(this.firestore,null,e)}}Fo="9.0.0",W(new N("firestore",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=new Jl(n,new Zo(t.getProvider("auth-internal")));return e=Object.assign({useFetchStreams:!0},e),r._setSettings(e),r}),"PUBLIC")),tt("@firebase/firestore","3.0.2",void 0);var ld=n(676);const dd="w:0.5.0",fd=new m("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function pd(t){return t instanceof g&&t.code.includes("request-failed")}function gd({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function md(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function yd(t,e){const n=(await e.json()).error;return fd.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function vd({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function wd(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Id(t){return new Promise((e=>{setTimeout(e,t)}))}const bd=/^[cdef][\w-]{21}$/;function Td(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return bd.test(e)?e:""}catch(t){return""}}function _d(t){return`${t.appName}!${t.appId}`}const Ed=new Map;function Sd(t,e){const n=_d(t);kd(n,e),function(t,e){const n=(!Ad&&"BroadcastChannel"in self&&(Ad=new BroadcastChannel("[Firebase] FID Change"),Ad.onmessage=t=>{kd(t.data.key,t.data.fid)}),Ad);n&&n.postMessage({key:t,fid:e}),0===Ed.size&&Ad&&(Ad.close(),Ad=null)}(n,e)}function kd(t,e){const n=Ed.get(t);if(n)for(const t of n)t(e)}let Ad=null;const Cd="firebase-installations-store";let Nd=null;function Dd(){return Nd||(Nd=(0,ld.openDb)("firebase-installations-database",1,(t=>{0===t.oldVersion&&t.createObjectStore(Cd)}))),Nd}async function Rd(t,e){const n=_d(t),r=(await Dd()).transaction(Cd,"readwrite"),i=r.objectStore(Cd),s=await i.get(n);return await i.put(e,n),await r.complete,s&&s.fid===e.fid||Sd(t,e.fid),e}async function Od(t){const e=_d(t),n=(await Dd()).transaction(Cd,"readwrite");await n.objectStore(Cd).delete(e),await n.complete}async function Pd(t,e){const n=_d(t),r=(await Dd()).transaction(Cd,"readwrite"),i=r.objectStore(Cd),s=await i.get(n),o=e(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||Sd(t,o.fid),o}async function Ld(t){let e;const n=await Pd(t,(n=>{const r=function(t){return Ud(t||{fid:Td(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(fd.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(t,e){try{const n=await async function(t,{fid:e}){const n=gd(t),r=vd(t),i={fid:e,authVersion:"FIS_v2",appId:t.appId,sdkVersion:dd},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await wd((()=>fetch(n,s)));if(o.ok){const t=await o.json();return{fid:t.fid||e,registrationStatus:2,refreshToken:t.refreshToken,authToken:md(t.authToken)}}throw await yd("Create Installation",o)}(t,e);return Rd(t,n)}catch(n){throw pd(n)&&409===n.customData.serverCode?await Od(t):await Rd(t,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Md(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Md(t){let e=await xd(t);for(;1===e.registrationStatus;)await Id(100),e=await xd(t);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Ld(t);return n||e}return e}function xd(t){return Pd(t,(t=>{if(!t)throw fd.create("installation-not-found");return Ud(t)}))}function Ud(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Fd({appConfig:t,platformLoggerProvider:e},n){const r=function(t,{fid:e}){return`${gd(t)}/${e}/authTokens:generate`}(t,n),i=function(t,{refreshToken:e}){const n=vd(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:dd}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await wd((()=>fetch(r,a)));if(c.ok)return md(await c.json());throw await yd("Generate Auth Token",c)}async function Vd(t,e=!1){let n;const r=await Pd(t.appConfig,(r=>{if(!Bd(r))throw fd.create("not-registered");const i=r.authToken;if(!e&&(2===(s=i).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(s)))return r;var s;if(1===i.requestStatus)return n=async function(t,e){let n=await jd(t.appConfig);for(;1===n.authToken.requestStatus;)await Id(100),n=await jd(t.appConfig);const r=n.authToken;return 0===r.requestStatus?Vd(t,e):r}(t,e),r;{if(!navigator.onLine)throw fd.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(r);return n=async function(t,e){try{const n=await Fd(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Rd(t.appConfig,r),n}catch(n){if(!pd(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Rd(t.appConfig,n)}else await Od(t.appConfig);throw n}}(t,e),e}}));return n?await n:r.authToken}function jd(t){return Pd(t,(t=>{if(!Bd(t))throw fd.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Bd(t){return void 0!==t&&2===t.registrationStatus}function qd(t){return fd.create("missing-app-config-values",{valueName:t})}const zd="installations";W(new N(zd,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw qd("App Configuration");if(!t.name)throw qd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw qd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,platformLoggerProvider:J(e,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),W(new N("installations-internal",(t=>{const e=J(t.getProvider("app").getImmediate(),zd).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:r}=await Ld(e.appConfig);return r?r.catch(console.error):Vd(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Ld(t);e&&await e}(n.appConfig),(await Vd(n,e)).token}(e,t)}}),"PRIVATE")),tt("@firebase/installations","0.5.0");const Kd="0.5.0",Hd=Kd,$d="FB-PERF-TRACE-MEASURE",Gd="_wt_",Wd="_fcp",Jd="_fid",Xd="@firebase/performance/config",Qd="@firebase/performance/configexpire",Yd="Performance",Zd=new m("performance",Yd,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),tf=new j(Yd);let ef,nf,rf,sf;tf.logLevel=L.INFO;class of{constructor(t){if(this.window=t,!t)throw Zd.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(t){this.performance&&this.performance.mark&&this.performance.mark(t)}measure(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)}getEntriesByType(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]}getEntriesByName(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!f()||(tf.info("IndexedDB is not supported by current browswer"),!1):(tf.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(t,e){this.PerformanceObserver&&new this.PerformanceObserver((t=>{for(const n of t.getEntries())e(n)})).observe({entryTypes:[t]})}static getInstance(){return void 0===ef&&(ef=new of(nf)),ef}}function af(){return rf}function cf(t,e){const n=t.length-e.length;if(n<0||n>1)throw Zd.create("invalid String merger input");const r=[];for(let n=0;n<t.length;n++)r.push(t.charAt(n)),e.length>n&&r.push(e.charAt(n));return r.join("")}class uf{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=cf("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=cf("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===sf&&(sf=new uf),sf}}var hf;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(hf||(hf={}));const lf=["firebase_","google_","ga_"],df=new RegExp("^[a-zA-Z]\\w*$");function ff(){const t=of.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function pf(){switch(of.getInstance().document.visibilityState){case"visible":return hf.VISIBLE;case"hidden":return hf.HIDDEN;default:return hf.UNKNOWN}}function gf(){const t=of.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function mf(t){var e;const n=null===(e=t.options)||void 0===e?void 0:e.appId;if(!n)throw Zd.create("no app id");return n}const yf="Could not fetch config, will use default configs";function vf(t){if(!t)return t;const e=uf.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=wf(e.tracesSamplingRate),e.logNetworkAfterSampling=wf(e.networkRequestsSamplingRate),t}function wf(t){return Math.random()<=t}let If,bf=1;function Tf(t){return bf=2,If=If||function(t){return function(){const t=of.getInstance().document;return new Promise((e=>{if(t&&"complete"!==t.readyState){const n=()=>{"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((()=>function(t){const e=t.getId();return e.then((t=>{rf=t})),e}(t.installations))).then((e=>function(t,e){const n=function(){const t=of.getInstance().localStorage;if(!t)return;const e=t.getItem(Qd);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;const r=t.getItem(Xd);if(r)try{return JSON.parse(r)}catch(t){return}}();return n?(vf(n),Promise.resolve()):function(t,e){return function(t){const e=t.getToken();return e.then((t=>{})),e}(t.installations).then((n=>{const r=function(t){var e;const n=null===(e=t.options)||void 0===e?void 0:e.projectId;if(!n)throw Zd.create("no project id");return n}(t.app),i=function(t){var e;const n=null===(e=t.options)||void 0===e?void 0:e.apiKey;if(!n)throw Zd.create("no api key");return n}(t.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`FIREBASE_INSTALLATIONS_AUTH ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:mf(t.app),app_version:Hd,sdk_version:"0.0.1"})});return fetch(s).then((t=>{if(t.ok)return t.json();throw Zd.create("RC response not ok")}))})).catch((()=>{tf.info(yf)}))}(t,e).then(vf).then((t=>function(t){const e=of.getInstance().localStorage;t&&e&&(e.setItem(Xd,JSON.stringify(t)),e.setItem(Qd,String(Date.now()+60*uf.getInstance().configTimeToLive*60*1e3)))}(t)),(()=>{}))}(t,e))).then((()=>_f()),(()=>_f()))}(t),If}function _f(){bf=3}const Ef=1e4;let Sf,kf=3,Af=[],Cf=!1;function Nf(t){setTimeout((()=>{if(0!==kf)return Af.length?void function(){const t=Af.splice(0,1e3),e=t.map((t=>({source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)})));(function(t,e){return function(t){const e=uf.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((t=>(t.ok||tf.info("Call to Firebase backend failed."),t.json()))).then((t=>{const n=Number(t.nextRequestWaitMillis);let r=Ef;isNaN(n)||(r=Math.max(n,r));const i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(Af=[...e,...Af],tf.info("Retry transport request later.")),kf=3,Nf(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:uf.getInstance().logSource,log_event:e},t).catch((()=>{Af=[...t,...Af],kf--,tf.info(`Tries left: ${kf}.`),Nf(Ef)}))}():Nf(Ef)}),t)}function Df(t,e){Sf||(Sf=function(t){return(...e)=>{!function(t){if(!t.eventTime||!t.message)throw Zd.create("invalid cc log");Af=[...Af,t]}({message:t(...e),eventTime:Date.now()})}}(Pf)),Sf(t,e)}function Rf(t){const e=uf.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&of.getInstance().requiredApisAvailable()&&(t.isAuto&&pf()!==hf.VISIBLE||(3===bf?Of(t):Tf(t.performanceController).then((()=>Of(t)),(()=>Of(t)))))}function Of(t){if(!af())return;const e=uf.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((()=>Df(t,1)),0)}function Pf(t,e){return 0===e?function(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:Lf(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}(t):function(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);const n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);const r={application_info:Lf(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}(t)}function Lf(t){return{google_app_id:mf(t),app_instance_id:af(),web_app_info:{sdk_version:Hd,page_url:of.getInstance().getUrl(),service_worker_status:ff(),visibility_state:pf(),effective_connection_type:gf()},application_process_state:0}}const Mf=["_fp",Wd,Jd];class xf{constructor(t,e,n=!1,r){this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=of.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`FB-PERF-TRACE-MEASURE-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Zd.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Zd.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Rf(this)}record(t,e,n){if(t<=0)throw Zd.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Zd.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const t of Object.keys(n.metrics))isNaN(Number(n.metrics[t]))||(this.counters[t]=Number(Math.floor(n.metrics[t])));Rf(this)}incrementMetric(t,e=1){void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)}putMetric(t,e){if(n=t,r=this.name,0===n.length||n.length>100||!(r&&r.startsWith(Gd)&&Mf.indexOf(n)>-1)&&n.startsWith("_"))throw Zd.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=function(t){const e=Math.floor(t);return e<t&&tf.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}(e)}getMetric(t){return this.counters[t]||0}putAttribute(t,e){const n=!(0===(r=t).length||r.length>40||lf.some((t=>r.startsWith(t)))||!r.match(df));var r;const i=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&i)this.customAttributes[t]=e;else{if(!n)throw Zd.create("invalid attribute name",{attributeName:t});if(!i)throw Zd.create("invalid attribute value",{attributeValue:e})}}getAttribute(t){return this.customAttributes[t]}removeAttribute(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(t){this.startTimeUs=t}setDuration(t){this.durationUs=t}calculateTraceMetrics(){const t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))}static createOobTrace(t,e,n,r){const i=of.getInstance().getUrl();if(!i)return;const s=new xf(t,Gd+i,!0),o=Math.floor(1e3*of.getInstance().getTimeOrigin());if(s.setStartTime(o),e&&e[0]&&(s.setDuration(Math.floor(1e3*e[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){const t=n.find((t=>"first-paint"===t.name));t&&t.startTime&&s.putMetric("_fp",Math.floor(1e3*t.startTime));const e=n.find((t=>"first-contentful-paint"===t.name));e&&e.startTime&&s.putMetric(Wd,Math.floor(1e3*e.startTime)),r&&s.putMetric(Jd,Math.floor(1e3*r))}Rf(s)}static createUserTimingTrace(t,e){Rf(new xf(t,e,!1,e))}}function Uf(t,e){const n=e;if(!n||void 0===n.responseStart)return;const r=of.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(t){const e=uf.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((()=>Df(t,0)),0)}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}function Ff(t){af()&&(setTimeout((()=>function(t){const e=of.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){let i=setTimeout((()=>{xf.createOobTrace(t,n,r),i=void 0}),5e3);e.onFirstInputDelay((e=>{i&&(clearTimeout(i),xf.createOobTrace(t,n,r,e))}))}else xf.createOobTrace(t,n,r)}(t)),0),setTimeout((()=>function(t){const e=of.getInstance(),n=e.getEntriesByType("resource");for(const e of n)Uf(t,e);e.setupObserver("resource",(e=>Uf(t,e)))}(t)),0),setTimeout((()=>function(t){const e=of.getInstance(),n=e.getEntriesByType("measure");for(const e of n)Vf(t,e);e.setupObserver("measure",(e=>Vf(t,e)))}(t)),0))}function Vf(t,e){const n=e.name;n.substring(0,$d.length)!==$d&&xf.createUserTimingTrace(t,n)}class jf{constructor(t,e){this.app=t,this.installations=e,this.initialized=!1}_init(t){this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),of.getInstance().requiredApisAvailable()?p().then((t=>{t&&(Cf||(Nf(5500),Cf=!0),Tf(this).then((()=>Ff(this)),(()=>Ff(this))),this.initialized=!0)})).catch((t=>{tf.info(`Environment doesn't support IndexedDB: ${t}`)})):tf.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(t){uf.getInstance().instrumentationEnabled=t}get instrumentationEnabled(){return uf.getInstance().instrumentationEnabled}set dataCollectionEnabled(t){uf.getInstance().dataCollectionEnabled=t}get dataCollectionEnabled(){return uf.getInstance().dataCollectionEnabled}}W(new N("performance",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==n.name)throw Zd.create("FB not default");if("undefined"==typeof window)throw Zd.create("no window");!function(t){nf=t}(window);const i=new jf(n,r);return i._init(e),i}),"PUBLIC")),tt("@firebase/performance",Kd);const Bf="analytics",qf="https://www.googletagmanager.com/gtag/js",zf=new j("@firebase/analytics");function Kf(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const Hf=new m("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),$f=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Gf(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Wf(t,e=$f,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Hf.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Hf.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Xf;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Jf({appId:r,apiKey:i,measurementId:s},o,a,e)}async function Jf(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=$f){const{appId:s,measurementId:o}=t;try{await function(t,e){return new Promise(((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener((()=>{clearTimeout(s),r(Hf.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(r,e)}catch(t){if(o)return zf.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:Gf(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw Hf.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return i.deleteThrottleMetadata(s),e}catch(e){if(!function(t){if(!(t instanceof g&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(i.deleteThrottleMetadata(s),o)return zf.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}const a=503===Number(e.customData.httpStatus)?k(n,i.intervalMillis,30):k(n,i.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return i.setThrottleMetadata(s,c),zf.debug(`Calling attemptFetch again in ${a} millis`),Jf(t,c,r,i)}}class Xf{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}class Qf{constructor(t){this.app=t}_delete(){return delete Yf[this.app.options.appId],Promise.resolve()}}let Yf={},Zf=[];const tp={};let ep,np,rp="dataLayer",ip=!1;function sp(t,e,n){!function(){const t=[];if(h()&&t.push("This is a browser extension environment."),navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=Hf.create("invalid-analytics-context",{errorInfo:e});zf.warn(n.message)}}();const r=t.options.appId;if(!r)throw Hf.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Hf.create("no-api-key");zf.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Yf[r])throw Hf.create("already-exists",{id:r});if(!ip){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,r,i){let s=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(t,e,n,r){return async function(i,s,o){try{"event"===i?await async function(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let t=i.send_to;Array.isArray(t)||(t=[t]);const r=await Kf(n);for(const n of t){const t=r.find((t=>t.measurementId===n)),i=t&&e[t.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(t){zf.error(t)}}(t,e,n,s,o):"config"===i?await async function(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const t=(await Kf(n)).find((t=>t.measurementId===i));t&&await e[t.appId]}}catch(t){zf.error(t)}t("config",i,s)}(t,e,n,r,s,o):t("set",s)}catch(t){zf.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window.gtag}}(Yf,Zf,tp);np=t,ep=e,ip=!0}return Yf[r]=async function(t,e,n,r,i,s,o){var a;const c=Wf(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&zf.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>zf.error(t))),e.push(c);const u=async function(){if(!f())return zf.warn(Hf.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await p()}catch(t){return zf.warn(Hf.create("indexeddb-unavailable",{errorInfo:t}).message),!1}return!0}().then((t=>t?r.getId():void 0)),[h,l]=await Promise.all([c,u]);(function(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(qf))return e;return null})()||function(t,e){const n=document.createElement("script");n.src=`${qf}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(s,h.measurementId),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=l&&(d.firebase_id=l),i("config",h.measurementId,d),h.measurementId}(t,Zf,tp,e,ep,rp,n),new Qf(t)}W(new N(Bf,((t,{options:e})=>sp(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),W(new N("analytics-internal",(function(t){try{const e=t.getProvider(Bf).getImmediate();return{logEvent:(t,n,r)=>function(t,e,n,r){t=A(t),async function(t,e,n,r,i){if(i&&i.global)t("event",n,r);else{const i=await e;t("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(np,Yf[t.app.options.appId],e,n,r).catch((t=>zf.error(t)))}(e,t,n,r)}}catch(t){throw Hf.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),tt("@firebase/analytics","0.7.0");const op=function(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),r=n.name;if("string"!=typeof r||!r)throw X.create("bad-app-name",{appName:String(r)});const i=H.get(r);if(i){if(w(t,i.options)&&w(n,i.config))return i;throw X.create("duplicate-app",{appName:r})}const s=new O(r);for(const t of $.values())s.addComponent(t);const o=new Q(t,n,s);return H.set(r,o),o}({apiKey:"AIzaSyCLtTnAVBuPzBL_dFK-ClbCHP2Dqp3gW4g",authDomain:"stem-day-project-43876.firebaseapp.com",projectId:"stem-day-project-43876",storageBucket:"stem-day-project-43876.appspot.com",messagingSenderId:"366923636539",appId:"1:366923636539:web:f85b89b2ddc315e67ee11e"}),ap=(function(t=Z()){J(t=A(t),"performance").getImmediate()}(op),function(t=Z()){const e=J(t=A(t),Bf);e.isInitialized()?e.getImmediate():function(t,e={}){const n=J(t,Bf);if(n.isInitialized()){const t=n.getImmediate();if(w(e,n.getOptions()))return t;throw Hf.create("already-initialized")}n.initialize({options:e})}(t)}(op),document.getElementById("info")),cp=document.getElementById("login"),up=document.getElementById("login-github"),hp=document.getElementById("twitter"),lp=document.getElementById("logout"),dp=(document.getElementById("deleteAccount"),new fe),fp=new pe,pp=new ge,gp=function(t=Z()){const e=J(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=J(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(w(n.getOptions(),null!=e?e:{}))return t;st(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:bn,persistence:[je,_e,Se]})}(),mp=function(t=Z()){return J(t,"firestore").getImmediate()}();cp.addEventListener("click",(()=>{Xe(gp,dp).then((()=>{console.log("Yay! Signed in")})).catch((t=>{console.error(t)}))})),up.addEventListener("click",(()=>{Xe(gp,fp).then((()=>{console.log("Signed in with GitHub")})).catch((t=>{console.error(t)}))})),lp.addEventListener("click",(()=>{(function(t){return A(t).signOut()})(gp).then((()=>{console.log("Sucessfully signed out")})).catch((t=>{console.error(t)}))})),hp.addEventListener("click",(()=>{Xe(gp,pp).then((()=>{console.log("Signed in with Twitter")})).catch((t=>{console.error(t)}))})),function(t,e,n,r){A(t).onAuthStateChanged((t=>{t?(cp.style.display="none",up.style.display="none",hp.style.display="none",lp.style.display="block",ap.innerHTML=`Greetings ${t.displayName}`):(cp.style.display="block",up.style.display="block",hp.style.display="block",lp.style.display="none",ap.innerHTML="")}),void 0,void 0)}(gp);const yp=function(t,...e){for(const n of e)t=n._apply(t);return t}(function(t,e,...n){if(t=A(t),function(t,e,n){if(!n)throw new Jo(Wo.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}("collection","path",e),t instanceof zl){const r=la.fromString(e,...n);return jl(r),new $l(t,null,r)}{if(!(t instanceof Kl||t instanceof $l))throw new Jo(Wo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(la.fromString(e,...n));return jl(r),new $l(t.firestore,null,r)}}(mp,"movies"));!function(t,...e){var n,r,i;t=A(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Wl(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Wl(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(r=t.error)||void 0===r?void 0:r.bind(t),e[o+2]=null===(i=t.complete)||void 0===i?void 0:i.bind(t)}let c,u,h;if(t instanceof Kl)u=Bl(t.firestore,Jl),h=ac(t._key.path),c={next:n=>{e[o]&&e[o](function(t,e,n){const r=n.docs.get(e._key),i=new hd(t);return new od(t,i,e._key,r,new sd(n.hasPendingWrites,n.fromCache),e.converter)}(u,t,n))},error:e[o+1],complete:e[o+2]};else{const n=Bl(t,Hl);u=Bl(n.firestore,Jl),h=n._query;const r=new hd(u);c={next:t=>{e[o]&&e[o](new cd(u,r,n,t))},error:e[o+1],complete:e[o+2]},function(t){if(uc(t)&&0===t.explicitOrderBy.length)throw new Jo(Wo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}!function(t,e,n,r){const i=new Pl(r),s=new ll(e,i,n);t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=Go(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new ol),i)try{s.Xr=await n.onListen(r)}catch(t){const n=nl(t,`Initialization of query '${pc(e.query)}' failed`);return void e.onError(n)}n.queries.set(r,s),s.listeners.push(e),e.eo(n.onlineState),s.Xr&&e.no(s.Xr)&&hl(n)}(await xl(t),s)))}(function(t){return t._firestoreClient||Xl(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(u),h,a,c)}(yp,(t=>{t.forEach((t=>{console.log(t.data())}))}))})()})();